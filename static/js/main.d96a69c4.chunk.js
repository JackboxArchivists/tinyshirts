(this.webpackJsonpacdesigns=this.webpackJsonpacdesigns||[]).push([[0],{143:function(t,e,n){t.exports=n(160)},148:function(t,e,n){},150:function(t,e,n){"use strict";n.r(e),e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:9e3,r=BigInt("144066263297769815596495629667062367629"),i=BigInt("309485009821345068724781371");if("string"==typeof t)for(var a=Math.min(e+n,t.length),o=e;o<a;o++)r^=BigInt(t.charCodeAt(o)),r=BigInt.asUintN(128,r*i);else if(t instanceof Uint8Array)for(var s=Math.min(e+n,t.byteLength),h=e;h<s;h++)r^=BigInt(t[h]),r=BigInt.asUintN(128,r*i);else if(t instanceof ArrayBuffer)for(var u=new Uint8Array(t),l=Math.min(e+n,u.byteLength),c=e;c<l;c++)r^=BigInt(u[c]),r=BigInt.asUintN(128,r*i);return("0000000000000000000000000000000"+r.toString(16)).substr(-32)}},151:function(t,e,n){},158:function(t,e,n){},159:function(t,e,n){},160:function(t,e,n){"use strict";n.r(e);var r=n(0),i=n.n(r),a=n(55),o=n.n(a),s=(n(148),n(84)),h=n.n(s),u=n(117),l=n(2),c=n(3),f=n(32),v=n(9),w=n(10),d=n(161),y=n(173),g=n(180),p=n(177),m=n(175),I=n(174),A=n(83),S=n(178),k=n(22),E=n(176),C=n(131),O=n(127),b=n.n(O),_=n(150),T=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(Object(l.a)(this,t),this.b=null,e instanceof ArrayBuffer){this.b=new ArrayBuffer(e.byteLength>620?2160:620),this.dataView=new DataView(this.b,0,this.b.byteLength),this.dataBytes=new Uint8Array(this.b,0,this.b.byteLength);for(var n=new Uint8Array(e,0,e.byteLength),r=0;r<e.byteLength&&r<this.b.byteLength;++r)this.dataBytes[r]=n[r]}if(e instanceof Uint8Array){this.b=new ArrayBuffer(e.byteLength>620?2160:620),this.dataView=new DataView(this.b,0,this.b.byteLength),this.dataBytes=new Uint8Array(this.b,0,this.b.byteLength);for(var i=0;i<e.byteLength&&i<this.b.byteLength;++i)this.dataBytes[i]=e[i]}if("string"===typeof e&&e.length>=620){this.b=new ArrayBuffer(e.length>620?2160:620),this.dataView=new DataView(this.b,0,this.b.byteLength),this.dataBytes=new Uint8Array(this.b,0,this.b.byteLength);for(var a=0;a<e.length&&a<this.b.byteLength;++a)this.dataBytes[a]=e.charCodeAt(a)}if(null===this.b){var o=9;"number"===typeof e&&(o=e),this.b=new ArrayBuffer(t.bytesForType(o)),this.dataView=new DataView(this.b,0,this.b.byteLength),this.dataBytes=new Uint8Array(this.b,0,this.b.byteLength),this.title="Empty",this.creator=["Unknown",0],this.town=["Unknown",0],this.unknown_a=12569,this.setDefaultPalette(),this.unknown_b=204,this.unknown_c=10,this.patternType=o}t.typeInfo[this.patternType]?this.currMask=t.typeInfo[this.patternType].mask:this.currMask=null}return Object(c.a)(t,[{key:"utf16_decode",value:function(t,e){for(var n="",r=0;r<e;r+=2){var i=this.dataView.getUint16(t+r,!0);if(0===i)return n;n+=String.fromCharCode(i)}return n}},{key:"utf16_encode",value:function(t,e,n){for(var r=0;r<e/2;r++)r>=n.length?this.dataView.setUint16(t+2*r,0,!0):this.dataView.setUint16(t+2*r,n.charCodeAt(r),!0)}},{key:"toString",value:function(){for(var t="",e=Math.min(this.byteLength,this.b.byteLength),n=0;n<e;n++)t+=String.fromCharCode(this.dataBytes[n]);return t}},{key:"toJSON",value:function(e){return{title:this.title,author:[this.creator,this.town],unknown:{A:this.unknown_a,B:this.unknown_b,C:this.unknown_c,D:this.unknown_d},texture_size:this.width,pattern_type:this.patternType,pattern_type_str:t.getTypeStr(this.patternType)}}},{key:"toPixels",value:function(t){for(var e=0,n=108;n<this.b.byteLength&&e<t.byteLength;n++)t[e++]=15&this.dataBytes[n],t[e++]=this.dataBytes[n]>>4&15;if(this.currMask)for(var r=0;r<t.byteLength;r++)this.currMask[r>>5]&1<<(31&r)&&(t[r]=252)}},{key:"fromPixels",value:function(t){for(var e=0,n=108;n<this.b.byteLength;n++)this.dataBytes[n]=(15&t[e])+((15&t[e+1])<<4),e+=2}},{key:"getPalette",value:function(t){return t<0||t>14?0:this.dataBytes[88+t]}},{key:"setPalette",value:function(t,e){t<0||t>14||(this.dataBytes[88+t]=e)}},{key:"setDefaultPalette",value:function(){for(var t=0;t<15;t++)this.dataBytes[88+t]=16*t+15}},{key:"pixelHash",value:function(){return _(this.b,88,this.width>32?2068:532)}},{key:"fullHash",value:function(){return _(this.b,0,this.byteLength)}},{key:"fixIssues",value:function(){this.creator[1]||(this.creator=60598),this.town[1]||(this.town=50500),this.dataBytes[84]=0,this.dataBytes[85]=0,this.dataBytes[62]>1&&(this.dataBytes[62]=0),this.dataBytes[63]=0,this.dataBytes[40]=0,this.dataBytes[41]=0}},{key:"title",set:function(t){this.utf16_encode(0,40,t)},get:function(){return this.utf16_decode(0,40)}},{key:"creator",set:function(t){if(t instanceof Array&&2===t.length)return this.creator=t[0],void(this.creator=t[1]);"string"===typeof t&&this.utf16_encode(44,18,t),"number"===typeof t&&this.dataView.setUint16(42,t,!0)},get:function(){return[this.utf16_decode(44,18),this.dataView.getUint16(42,!0),this.dataBytes[68]?"Male":"Female"]}},{key:"town",set:function(t){if(t instanceof Array&&2===t.length)return this.town=t[0],void(this.town=t[1]);"string"===typeof t&&this.utf16_encode(66,18,t),"number"===typeof t&&this.dataView.setUint16(64,t,!0)},get:function(){return[this.utf16_decode(66,18),this.dataView.getUint16(64,!0)]}},{key:"unknown_a",set:function(t){this.dataView.setUint16(86,t,!0)},get:function(){return this.dataView.getUint16(86,!0)}},{key:"unknown_b",set:function(t){this.dataBytes[103]=t},get:function(){return this.dataBytes[103]}},{key:"unknown_c",set:function(t){this.dataBytes[104]=t},get:function(){return this.dataBytes[104]}},{key:"patternType",set:function(e){if(this.width!==t.widthForType(e)){for(var n=new ArrayBuffer(t.widthForType(e)>32?2160:620),r=new DataView(n),i=new Uint8Array(n),a=0;a<n.byteLength&&a<this.b.byteLength;++a)i[a]=this.dataBytes[a];this.dataView=r,this.dataBytes=i,this.b=n}this.dataBytes[105]=e,t.typeInfo[this.patternType]?this.currMask=t.typeInfo[this.patternType].mask:this.currMask=null},get:function(){return this.dataBytes[105]}},{key:"unknown_d",set:function(t){this.dataView.setUint16(106,t,!0)},get:function(){return this.dataView.getUint16(106,!0)}},{key:"width",get:function(){return t.typeInfo[this.dataBytes[105]]?t.typeInfo[this.dataBytes[105]].size:32}},{key:"height",get:function(){return t.typeInfo[this.dataBytes[105]]?t.typeInfo[this.dataBytes[105]].size:32}},{key:"byteLength",get:function(){return this.width>32?2160:620}}],[{key:"getTypeStr",value:function(e){return t.typeInfo[e]&&t.typeInfo[e].name?t.typeInfo[e].name:"Unimplemented pattern type"}},{key:"widthForType",value:function(e){return t.typeInfo[e].size}},{key:"bytesForType",value:function(t){return this.widthForType(t)>32?2160:620}}]),t}();T.paletteColors=["#FFEEFF","#FF99AA","#EE5599","#FF66AA","#FF0066","#BB4477","#CC0055","#990033","#552233","","","","","","","#FFFFFF","#FFBBCC","#FF7777","#DD3210","#FF5544","#FF0000","#CC6666","#BB4444","#BB0000","#882222","","","","","","","#EEEEEE","#DDCDBB","#FFCD66","#DD6622","#FFAA22","#FF6600","#BB8855","#DD4400","#BB4400","#663210","","","","","","","#DDDDDD","#FFEEDD","#FFDDCC","#FFCDAA","#FFBB88","#FFAA88","#DD8866","#BB6644","#995533","#884422","","","","","","","#CCCDCC","#FFCDFF","#EE88FF","#CC66DD","#BB88CC","#CC00FF","#996699","#8800AA","#550077","#330044","","","","","","","#BBBBBB","#FFBBFF","#FF99FF","#DD22BB","#FF55EE","#FF00CC","#885577","#BB0099","#880066","#550044","","","","","","","#AAAAAA","#DDBB99","#CCAA77","#774433","#AA7744","#993200","#773222","#552200","#331000","#221000","","","","","","","#999999","#FFFFCC","#FFFF77","#DDDD22","#FFFF00","#FFDD00","#CCAA00","#999900","#887700","#555500","","","","","","","#888888","#DDBBFF","#BB99EE","#6632CC","#9955FF","#6600FF","#554488","#440099","#220066","#221033","","","","","","","#777777","#BBBBFF","#8899FF","#3332AA","#3355EE","#0000FF","#333288","#0000AA","#101066","#000022","","","","","","","#666666","#99EEBB","#66CD77","#226610","#44AA33","#008833","#557755","#225500","#103222","#002210","","","","","","","#555555","#DDFFBB","#CCFF88","#88AA55","#AADD88","#88FF00","#AABB99","#66BB00","#559900","#336600","","","","","","","#444444","#BBDDFF","#77CDFF","#335599","#6699FF","#1077FF","#4477AA","#224477","#002277","#001044","","","","","","","#333233","#AAFFFF","#55FFFF","#0088BB","#55BBCC","#00CDFF","#4499AA","#006688","#004455","#002233","","","","","","","#222222","#CCFFEE","#AAEEDD","#33CDAA","#55EEBB","#00FFCC","#77AAAA","#00AA99","#008877","#004433","","","","","","","#000000","#AAFFAA","#77FF77","#66DD44","#00FF00","#22DD22","#55BB55","#00BB00","#008800","#224422","","","","","","",""],T.typeInfo=[],T.typeInfo[0]={name:"Dress, long sleeves",size:64,sections:[0,0,64,64]},T.typeInfo[1]={name:"Dress, short sleeves",size:64,sections:[0,0,64,64],mask:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},T.typeInfo[2]={name:"Dress, sleeveless",size:64,sections:[0,0,64,64],mask:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},T.typeInfo[3]={name:"Shirt, long sleeves",size:64,sections:[0,0,64,64],mask:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]},T.typeInfo[4]={name:"Shirt, short sleeves",size:64,sections:[0,0,64,64],mask:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-65536,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]},T.typeInfo[5]={name:"Shirt, sleeveless",size:64,sections:[0,0,64,64],mask:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]},T.typeInfo[6]={name:"Hat with horns",size:32,sections:[0,0,32,32]},T.typeInfo[7]={name:"Hat without horns",size:32,sections:[0,0,32,32]},T.typeInfo[8]={name:"Standee",size:64,sections:[0,0,52,64],mask:[0,0,0,0,0,0,0,0,0,0,0,0,0,1069547520,-524288,-131072,-65536,-32768,-16384,-16384,-8192,-8192,-8192,-8192,-8192,-16384,-16384,-32768,-65536,-262144,-1048576,528482304,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048575,-1048569,-1048561,-1048545,-1048513,-1048513,-1048449,-1048449,-1048449,-1048449,-1048449,-1048513,-1048545,-1048545,-1048561,-1048573,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576,-1048576]},T.typeInfo[9]={name:"Normal pattern (easel)",size:32,sections:[0,0,32,32]},T.RGBLookup=[],T.YUVLookup=[];for(var B=0;B<256;B++){var N=T.paletteColors[B];if(N.length<7)T.RGBLookup.push(null),T.YUVLookup.push(null);else{var R=[parseInt(N.substr(1,2),16),parseInt(N.substr(3,2),16),parseInt(N.substr(5,2),16)];T.RGBLookup.push(R),T.YUVLookup.push([.299*R[0]+.587*R[1]+.114*R[2],-.168736*R[0]+-.331264*R[1]+.5*R[2]+128,.5*R[0]+-.418688*R[1]+-.081312*R[2]+128])}}var M=T,F=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(l.a)(this,t),this.canvas=e,this.context=e.getContext("2d"),this.opt=n}return Object(c.a)(t,[{key:"calcZoom",value:function(t){this.context.imageSmoothingEnabled=!1,this.opt.tall?this.zoom=this.width/32:this.width<this.height?this.zoom=Math.floor(this.width/t):this.zoom=Math.floor(this.height/t)}},{key:"drawPixel",value:function(t,e,n){e>63&&!this.opt.tall&&(e-=64,t+=32),n.length?(this.context.fillStyle=n,this.context.fillRect(t*this.zoom,e*this.zoom,this.zoom,this.zoom)):this.context.clearRect(t*this.zoom,e*this.zoom,this.zoom,this.zoom),this.opt.grid&&(this.context.fillStyle=15===t?"#AA0000":"#AAAAAA",this.context.fillRect(t*this.zoom+this.zoom-(t%8===7?2:1),e*this.zoom,t%8===7?2:1,this.zoom),this.context.fillStyle=15===e?"#BB0000":"#AAAAAA",this.context.fillRect(t*this.zoom,e*this.zoom+this.zoom-(e%8===7?2:1),this.zoom,e%8===7?2:1)),"function"===typeof this.opt.drawCallback&&this.opt.drawCallback()}},{key:"blitFrom",value:function(t){if(this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.opt.tall?(this.context.drawImage(t.canvas,0,0,t.canvas.width/2,t.canvas.height,0,0,this.canvas.width,this.canvas.height/2),this.context.drawImage(t.canvas,t.canvas.width/2,0,t.canvas.width/2,t.canvas.height,0,this.canvas.height/2,this.canvas.width,this.canvas.height/2)):this.context.drawImage(t.canvas,0,0,t.canvas.width,t.canvas.height,0,0,this.canvas.width,this.canvas.height),this.opt.grid){for(var e=0;e<this.canvas.width/this.zoom;++e)this.context.fillStyle=15===e?"#AA0000":"#AAAAAA",this.context.fillRect((e+1)*this.zoom-(e%8===7?2:1),0,e%8===7?2:1,this.canvas.height);for(var n=0;n<this.canvas.height/this.zoom;++n)this.context.fillStyle=15===n?"#BB0000":"#AAAAAA",this.context.fillRect(0,(n+1)*this.zoom-(n%8===7?2:1),this.canvas.width,n%8===7?2:1)}"function"===typeof this.opt.drawCallback&&this.opt.drawCallback()}},{key:"width",get:function(){return this.canvas.width}},{key:"height",get:function(){return this.canvas.height}}]),t}();function D(t,e,n){n.drawPixel(t,e)}var P,U=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(l.a)(this,t),this.renderTargets=[],this.drawing=!1,this.handleOnLoad=[function(){e.render(),e.pushUndo()}],this.handleColorChange=[],this.reset(),this.undoHistory=[],this.redoHistory=[],null!==n&&this.load(n)}return Object(c.a)(t,[{key:"reset",value:function(){this.pattern=new M,this.pixels_buffer=new ArrayBuffer(4096),this.pixels=new Uint8Array(this.pixels_buffer),this.drawHandler=D,this.drawHandlerAlt=D,this.currentColor=0,this.undoHistory=[],this.redoHistory=[],this.onLoad()}},{key:"load",value:function(e){"string"===typeof e&&e.startsWith("LZ|")?this.pattern=new M(b.a.decompressFromBase64(e.substr(3))):"string"===typeof e&&e.startsWith("B6|")?this.pattern=new M(atob(e.substr(3))):this.pattern=e instanceof t?e.pattern:new M(e),this.pixels_buffer=new ArrayBuffer(4096),this.pixels=new Uint8Array(this.pixels_buffer),this.pattern.toPixels(this.pixels),this.currentColor=0,this.onLoad(),this.onColorChange()}},{key:"pushUndo",value:function(){for(var t=[],e=0;e<15;++e)t.push(this.pattern.getPalette(e));this.undoHistory.push({pixels:new Uint8Array(this.pixels),palette:t}),this.undoHistory.length>25&&this.undoHistory.splice(1,this.undoHistory.length-25)}},{key:"pushRedo",value:function(){for(var t=[],e=0;e<15;++e)t.push(this.pattern.getPalette(e));this.redoHistory.push({pixels:new Uint8Array(this.pixels),palette:t}),this.redoHistory.length>25&&this.redoHistory.splice(1,this.redoHistory.length-25)}},{key:"undo",value:function(){if(!this.undoHistory.length)return!1;this.pushRedo();for(var t=this.undoHistory.pop(),e=0;e<4096;++e)this.pixels[e]=t.pixels[e];for(var n=0;n<15;++n)this.pattern.setPalette(n,t.palette[n]);return this.onColorChange(),this.render(),!0}},{key:"redo",value:function(){if(!this.redoHistory.length)return!1;this.pushUndo();for(var t=this.redoHistory.pop(),e=0;e<4096;++e)this.pixels[e]=t.pixels[e];for(var n=0;n<15;++n)this.pattern.setPalette(n,t.palette[n]);return this.onColorChange(),this.render(),!0}},{key:"fixIssues",value:function(){this.pattern.fixIssues()}},{key:"findRGB",value:function(t){if("number"===typeof t)return t;var e=[];if("string"===typeof t&&7===t.length&&(e=[parseInt(t.substr(1,2),16),parseInt(t.substr(3,2),16),parseInt(t.substr(5,2),16)]),t instanceof Array&&(e=t),!e.length)return 0;for(var n=195075,r=0,i=0;i<256;i++){var a=M.RGBLookup[i];if(null!==a){var o=a[0]-e[0],s=a[1]-e[1],h=a[2]-e[2],u=o*o+s*s+h*h;if(u<n){if(!u)return i;n=u,r=i}}}return r}},{key:"findPalRGB",value:function(t){if("number"===typeof t)return t;var e=[];if("string"===typeof t&&7===t.length&&(e=[parseInt(t.substr(1,2),16),parseInt(t.substr(3,2),16),parseInt(t.substr(5,2),16)]),t instanceof Array&&(e=t),!e.length)return this.currentColor;for(var n=195075,r=0,i=0;i<15;i++){var a=M.RGBLookup[this.pattern.getPalette(i)];if(null!==a){var o=a[0]-e[0],s=a[1]-e[1],h=a[2]-e[2],u=o*o+s*s+h*h;if(u<n){if(!u)return i;n=u,r=i}}}return r}},{key:"findYUV",value:function(t){for(var e=[.299*t[0]+.587*t[1]+.114*t[2],-.168736*t[0]+-.331264*t[1]+.5*t[2]+128,.5*t[0]+-.418688*t[1]+-.081312*t[2]+128],n=195075,r=0,i=0;i<256;i++){var a=M.YUVLookup[i];if(null!==a){var o=a[0]-e[0],s=a[1]-e[1],h=a[2]-e[2],u=o*o+s*s+h*h;if(u<n){if(!u)return i;n=u,r=i}}}return r}},{key:"findPalYUV",value:function(t){for(var e=[.299*t[0]+.587*t[1]+.114*t[2],-.168736*t[0]+-.331264*t[1]+.5*t[2]+128,.5*t[0]+-.418688*t[1]+-.081312*t[2]+128],n=195075,r=0,i=0;i<15;i++){var a=M.YUVLookup[this.pattern.getPalette(i)];if(null!==a){var o=a[0]-e[0],s=a[1]-e[1],h=a[2]-e[2],u=o*o+s*s+h*h;if(u<n){if(!u)return i;n=u,r=i}}}return r}},{key:"setPalette",value:function(t,e){t<0||t>14||(this.pattern.setPalette(t,this.findRGB(e)),this.onColorChange(),this.render())}},{key:"getPalette",value:function(t){return t<0||t>14?"#FFFFFF00":M.paletteColors[this.pattern.getPalette(t)]}},{key:"handleCanvasClick",value:function(t){var e=0,n=0;void 0===t.offsetX?(e=t.pageX-t.target.offsetLeft,n=t.pageY-t.target.offsetTop):(e=t.offsetX,n=t.offsetY);var r=Math.floor(e/(t.target.width/this.pattern.width)),i=Math.floor(n/(t.target.height/this.pattern.width));1===t.which&&this.drawHandler(r,i,this),3===t.which&&this.drawHandlerAlt(r,i,this)}},{key:"addCanvas",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new F(t,n);r.calcZoom(this.pattern.width),n.tall||n.grid||!this.renderTargets.length||!this.renderTargets[0].opt.tall&&!this.renderTargets[0].opt.grid?this.renderTargets.push(r):this.renderTargets.unshift(r);var i=function(t){t.preventDefault()},a=function(t){var e=t.touches[0],n=e.target.getBoundingClientRect();return{offsetX:e.clientX-n.left,offsetY:e.clientY-n.top,which:1,target:e.target}};try{t.addEventListener("touchstart",(function(t){document.body.addEventListener("touchmove",i,{passive:!1}),e.drawing=!0,e.pushUndo(),e.handleCanvasClick(a(t))})),t.addEventListener("touchend",(function(){e.drawing=!1,document.body.removeEventListener("touchmove",i)})),t.addEventListener("touchmove",(function(t){e.drawing&&e.handleCanvasClick(a(t))}))}catch(o){}t.addEventListener("mousedown",(function(){e.drawing=!0,e.pushUndo()})),t.addEventListener("mouseup",(function(){e.drawing=!1})),t.addEventListener("mousemove",(function(t){!e.drawing||1!==t.which&&3!==t.which||e.handleCanvasClick(t)})),t.addEventListener("click",(function(t){e.handleCanvasClick(t)})),t.addEventListener("contextmenu",(function(t){e.handleCanvasClick(t),t.preventDefault()}))}},{key:"render",value:function(){if(this.renderTargets.length){for(var t=[],e=0;e<16;++e)t.push(this.getPalette(e));this.renderTargets[0].calcZoom(this.pattern.width);for(var n=32===this.pattern.width?1024:4096,r=0;r<n;r++){var i=r%32,a=Math.floor(r/32);252===this.pixels[r]||15===this.pixels[r]?this.renderTargets[0].drawPixel(i,a,""):this.renderTargets[0].drawPixel(i,a,t[this.pixels[r]])}for(var o=1;o<this.renderTargets.length;++o)this.renderTargets[o].calcZoom(this.pattern.width),this.renderTargets[o].blitFrom(this.renderTargets[0])}}},{key:"getPixel",value:function(t,e){if(t<0||e<0||t>63||e>63||isNaN(t)||isNaN(e))return!1;if(32===this.pattern.width&&(t>31||e>31))return!1;t>31&&(t-=32,e+=64);var n=t+32*e;return this.pixels[n]}},{key:"setPixel",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if("number"!==typeof n&&(n=this.findPalRGB(n)),t<0||e<0||n<0||n>15||t>63||e>63||isNaN(t)||isNaN(e))return!1;if(32===this.pattern.width&&(t>31||e>31))return!1;t>31&&(t-=32,e+=64);var r=t+32*e;return this.pixels[r]!==n&&252!==this.pixels[r]&&(this.pixels[r]=n)}},{key:"drawPixel",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!1!==(n=this.setPixel(t,e,n))){var r=M.paletteColors[this.pattern.getPalette(n)];for(var i in this.renderTargets)this.renderTargets[i].drawPixel(t,e,r)}}},{key:"onLoad",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===t)for(var e in this.handleOnLoad)this.handleOnLoad[e](this);else"function"===typeof t&&this.handleOnLoad.push(t)}},{key:"onColorChange",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===t)for(var e in this.handleColorChange)this.handleColorChange[e](this);else"function"===typeof t&&this.handleColorChange.push(t)}},{key:"toString",value:function(){return this.pattern.fromPixels(this.pixels),this.pattern.toString()}},{key:"toBytes",value:function(){return this.pattern.fromPixels(this.pixels),this.pattern.b}},{key:"toJSON",value:function(){return this.pattern.toJSON()}},{key:"color",get:function(){return this.getPalette(this.currentColor)},set:function(t){this.currentColor=this.findPalRGB(t)}},{key:"width",get:function(){return this.pattern.width}},{key:"height",get:function(){return this.pattern.height}},{key:"pixelCount",get:function(){return this.width*this.height}},{key:"fullHash",get:function(){return this.pattern.fullHash()}},{key:"pixelHash",get:function(){return this.pattern.pixelHash()}},{key:"title",get:function(){return this.pattern.title},set:function(t){this.pattern.title=t}},{key:"creator",get:function(){return this.pattern.creator},set:function(t){this.pattern.creator=t}},{key:"town",get:function(){return this.pattern.town},set:function(t){this.pattern.town=t}},{key:"authorStrict",get:function(){for(var t="",e=0;e<44;++e)t+=String.fromCharCode(this.pattern.dataBytes[42+e]);return t},set:function(t){for(var e=0;e<44;++e)this.pattern.dataBytes[42+e]=t.charCodeAt(e)}},{key:"patternType",get:function(){return this.pattern.patternType},set:function(t){this.pattern.patternType!==t&&(this.pattern.patternType=t,this.pattern.fromPixels(this.pixels),this.pattern.toPixels(this.pixels),this.onLoad())}},{key:"typeInfo",get:function(){return M.typeInfo[this.pattern.patternType]}},{key:"allTypes",get:function(){return M.typeInfo}}]),t}();!function(t){t[t.ERROR_CORRECTION=0]="ERROR_CORRECTION",t[t.CHARACTER_SET=1]="CHARACTER_SET",t[t.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",t[t.MIN_SIZE=3]="MIN_SIZE",t[t.MAX_SIZE=4]="MAX_SIZE",t[t.MARGIN=5]="MARGIN",t[t.PDF417_COMPACT=6]="PDF417_COMPACT",t[t.PDF417_COMPACTION=7]="PDF417_COMPACTION",t[t.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",t[t.AZTEC_LAYERS=9]="AZTEC_LAYERS",t[t.QR_VERSION=10]="QR_VERSION",t[t.STRUCTURED_APPEND=11]="STRUCTURED_APPEND"}(P||(P={}));var L=P,x=function(){function t(){Object(l.a)(this,t)}return Object(c.a)(t,null,[{key:"arraycopy",value:function(t,e,n,r,i){for(;i--;)n[r++]=t[e++]}},{key:"currentTimeMillis",value:function(){return Date.now()}}]),t}(),j=function(){function t(){Object(l.a)(this,t)}return Object(c.a)(t,null,[{key:"numberOfTrailingZeros",value:function(t){var e;if(0===t)return 32;var n=31;return 0!==(e=t<<16)&&(n-=16,t=e),0!==(e=t<<8)&&(n-=8,t=e),0!==(e=t<<4)&&(n-=4,t=e),0!==(e=t<<2)&&(n-=2,t=e),n-(t<<1>>>31)}},{key:"numberOfLeadingZeros",value:function(t){if(0===t)return 32;var e=1;return t>>>16===0&&(e+=16,t<<=16),t>>>24===0&&(e+=8,t<<=8),t>>>28===0&&(e+=4,t<<=4),t>>>30===0&&(e+=2,t<<=2),e-=t>>>31}},{key:"parseInt",value:function(t){return Number.parseInt(t)}},{key:"toBinaryString",value:function(t){return t.toString(2)}},{key:"toHexString",value:function(t){return t.toString(16)}},{key:"bitCount",value:function(t){return t=(t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135,t+=t>>>8,63&(t+=t>>>16)}}]),t}();j.MIN_VALUE_32_BITS=-2147483648;var z,H=function(){function t(){Object(l.a)(this,t)}return Object(c.a)(t,null,[{key:"asList",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e}},{key:"create",value:function(t,e,n){return Array.from({length:t}).map((function(t){return Array.from({length:e}).fill(n)}))}},{key:"createInt32Array",value:function(t,e,n){return Array.from({length:t}).map((function(t){return Int32Array.from({length:e}).fill(n)}))}},{key:"equals",value:function(t,e){if(!t)return!1;if(!e)return!1;if(!t.length)return!1;if(!e.length)return!1;if(t.length!==e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}},{key:"fill",value:function(t,e){for(var n=0;n!==t.length;n++)t[n]=e}},{key:"hashCode",value:function(t){if(null===t)return 0;var e,n=1,r=Object(k.a)(t);try{for(r.s();!(e=r.n()).done;){n=31*n+e.value}}catch(i){r.e(i)}finally{r.f()}return n}},{key:"copyOf",value:function(t,e){var n=new Int32Array(e);return x.arraycopy(t,0,n,0,Math.min(t.length,e)),n}},{key:"binarySearch",value:function(e,n,r){void 0===r&&(r=t.numberComparator);for(var i=0,a=e.length-1;i<=a;){var o=a+i>>1,s=r(n,e[o]);if(s>0)i=o+1;else{if(!(s<0))return o;a=o-1}}return-i-1}},{key:"numberComparator",value:function(t,e){return t-e}}]),t}(),V=function(t){Object(w.a)(n,t);var e=Object(v.a)(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return Object(l.a)(this,n),(t=e.call(this,r)).message=r,t}return n}(n(128).CustomError),G=function(t){Object(w.a)(n,t);var e=Object(v.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return n}(V),W=function(){function t(e,n){Object(l.a)(this,t),void 0===e?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,this.bits=void 0===n||null===n?t.makeArray(e):n)}return Object(c.a)(t,[{key:"getSize",value:function(){return this.size}},{key:"getSizeInBytes",value:function(){return Math.floor((this.size+7)/8)}},{key:"ensureCapacity",value:function(e){if(e>32*this.bits.length){var n=t.makeArray(e);x.arraycopy(this.bits,0,n,0,this.bits.length),this.bits=n}}},{key:"get",value:function(t){return 0!==(this.bits[Math.floor(t/32)]&1<<(31&t))}},{key:"set",value:function(t){this.bits[Math.floor(t/32)]|=1<<(31&t)}},{key:"flip",value:function(t){this.bits[Math.floor(t/32)]^=1<<(31&t)}},{key:"getNextSet",value:function(t){var e=this.size;if(t>=e)return e;var n=this.bits,r=Math.floor(t/32),i=n[r];i&=~((1<<(31&t))-1);for(var a=n.length;0===i;){if(++r===a)return e;i=n[r]}var o=32*r+j.numberOfTrailingZeros(i);return o>e?e:o}},{key:"getNextUnset",value:function(t){var e=this.size;if(t>=e)return e;var n=this.bits,r=Math.floor(t/32),i=~n[r];i&=~((1<<(31&t))-1);for(var a=n.length;0===i;){if(++r===a)return e;i=~n[r]}var o=32*r+j.numberOfTrailingZeros(i);return o>e?e:o}},{key:"setBulk",value:function(t,e){this.bits[Math.floor(t/32)]=e}},{key:"setRange",value:function(t,e){if(e<t||t<0||e>this.size)throw new G;if(e!==t){e--;for(var n=Math.floor(t/32),r=Math.floor(e/32),i=this.bits,a=n;a<=r;a++){var o=(2<<(a<r?31:31&e))-(1<<(a>n?0:31&t));i[a]|=o}}}},{key:"clear",value:function(){for(var t=this.bits.length,e=this.bits,n=0;n<t;n++)e[n]=0}},{key:"isRange",value:function(t,e,n){if(e<t||t<0||e>this.size)throw new G;if(e===t)return!0;e--;for(var r=Math.floor(t/32),i=Math.floor(e/32),a=this.bits,o=r;o<=i;o++){var s=(2<<(o<i?31:31&e))-(1<<(o>r?0:31&t))&4294967295;if((a[o]&s)!==(n?s:0))return!1}return!0}},{key:"appendBit",value:function(t){this.ensureCapacity(this.size+1),t&&(this.bits[Math.floor(this.size/32)]|=1<<(31&this.size)),this.size++}},{key:"appendBits",value:function(t,e){if(e<0||e>32)throw new G("Num bits must be between 0 and 32");this.ensureCapacity(this.size+e);for(var n=e;n>0;n--)this.appendBit(1===(t>>n-1&1))}},{key:"appendBitArray",value:function(t){var e=t.size;this.ensureCapacity(this.size+e);for(var n=0;n<e;n++)this.appendBit(t.get(n))}},{key:"xor",value:function(t){if(this.size!==t.size)throw new G("Sizes don't match");for(var e=this.bits,n=0,r=e.length;n<r;n++)e[n]^=t.bits[n]}},{key:"toBytes",value:function(t,e,n,r){for(var i=0;i<r;i++){for(var a=0,o=0;o<8;o++)this.get(t)&&(a|=1<<7-o),t++;e[n+i]=a}}},{key:"getBitArray",value:function(){return this.bits}},{key:"reverse",value:function(){for(var t=new Int32Array(this.bits.length),e=Math.floor((this.size-1)/32),n=e+1,r=this.bits,i=0;i<n;i++){var a=r[i];a=(a=(a=(a=(a=a>>1&1431655765|(1431655765&a)<<1)>>2&858993459|(858993459&a)<<2)>>4&252645135|(252645135&a)<<4)>>8&16711935|(16711935&a)<<8)>>16&65535|(65535&a)<<16,t[e-i]=a}if(this.size!==32*n){for(var o=32*n-this.size,s=t[0]>>>o,h=1;h<n;h++){var u=t[h];s|=u<<32-o,t[h-1]=s,s=u>>>o}t[n-1]=s}this.bits=t}},{key:"equals",value:function(e){if(!(e instanceof t))return!1;var n=e;return this.size===n.size&&H.equals(this.bits,n.bits)}},{key:"hashCode",value:function(){return 31*this.size+H.hashCode(this.bits)}},{key:"toString",value:function(){for(var t="",e=0,n=this.size;e<n;e++)0===(7&e)&&(t+=" "),t+=this.get(e)?"X":".";return t}},{key:"clone",value:function(){return new t(this.size,this.bits.slice())}}],[{key:"makeArray",value:function(t){return new Int32Array(Math.floor((t+31)/32))}}]),t}(),Z=function(t){Object(w.a)(n,t);var e=Object(v.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return n}(V);!function(t){t[t.Cp437=0]="Cp437",t[t.ISO8859_1=1]="ISO8859_1",t[t.ISO8859_2=2]="ISO8859_2",t[t.ISO8859_3=3]="ISO8859_3",t[t.ISO8859_4=4]="ISO8859_4",t[t.ISO8859_5=5]="ISO8859_5",t[t.ISO8859_6=6]="ISO8859_6",t[t.ISO8859_7=7]="ISO8859_7",t[t.ISO8859_8=8]="ISO8859_8",t[t.ISO8859_9=9]="ISO8859_9",t[t.ISO8859_10=10]="ISO8859_10",t[t.ISO8859_11=11]="ISO8859_11",t[t.ISO8859_13=12]="ISO8859_13",t[t.ISO8859_14=13]="ISO8859_14",t[t.ISO8859_15=14]="ISO8859_15",t[t.ISO8859_16=15]="ISO8859_16",t[t.SJIS=16]="SJIS",t[t.Cp1250=17]="Cp1250",t[t.Cp1251=18]="Cp1251",t[t.Cp1252=19]="Cp1252",t[t.Cp1256=20]="Cp1256",t[t.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",t[t.UTF8=22]="UTF8",t[t.ASCII=23]="ASCII",t[t.Big5=24]="Big5",t[t.GB18030=25]="GB18030",t[t.EUC_KR=26]="EUC_KR"}(z||(z={}));var K=function(){function t(e,n,r){Object(l.a)(this,t),this.valueIdentifier=e,this.name=r,this.values="number"===typeof n?Int32Array.from([n]):n;for(var i=arguments.length,a=new Array(i>3?i-3:0),o=3;o<i;o++)a[o-3]=arguments[o];this.otherEncodingNames=a,t.VALUE_IDENTIFIER_TO_ECI.set(e,this),t.NAME_TO_ECI.set(r,this);for(var s=this.values,h=0,u=s.length;h!==u;h++){var c=s[h];t.VALUES_TO_ECI.set(c,this)}for(var f=0,v=a;f<v.length;f++){var w=v[f];t.NAME_TO_ECI.set(w,this)}}return Object(c.a)(t,[{key:"getValueIdentifier",value:function(){return this.valueIdentifier}},{key:"getName",value:function(){return this.name}},{key:"getValue",value:function(){return this.values[0]}},{key:"equals",value:function(e){if(!(e instanceof t))return!1;var n=e;return this.getName()===n.getName()}}],[{key:"getCharacterSetECIByValue",value:function(e){if(e<0||e>=900)throw new Z("incorect value");var n=t.VALUES_TO_ECI.get(e);if(void 0===n)throw new Z("incorect value");return n}},{key:"getCharacterSetECIByName",value:function(e){var n=t.NAME_TO_ECI.get(e);if(void 0===n)throw new Z("incorect value");return n}}]),t}();K.VALUE_IDENTIFIER_TO_ECI=new Map,K.VALUES_TO_ECI=new Map,K.NAME_TO_ECI=new Map,K.Cp437=new K(z.Cp437,Int32Array.from([0,2]),"Cp437"),K.ISO8859_1=new K(z.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),K.ISO8859_2=new K(z.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),K.ISO8859_3=new K(z.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),K.ISO8859_4=new K(z.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),K.ISO8859_5=new K(z.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),K.ISO8859_6=new K(z.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),K.ISO8859_7=new K(z.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),K.ISO8859_8=new K(z.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),K.ISO8859_9=new K(z.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),K.ISO8859_10=new K(z.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),K.ISO8859_11=new K(z.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),K.ISO8859_13=new K(z.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),K.ISO8859_14=new K(z.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),K.ISO8859_15=new K(z.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),K.ISO8859_16=new K(z.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),K.SJIS=new K(z.SJIS,20,"SJIS","Shift_JIS"),K.Cp1250=new K(z.Cp1250,21,"Cp1250","windows-1250"),K.Cp1251=new K(z.Cp1251,22,"Cp1251","windows-1251"),K.Cp1252=new K(z.Cp1252,23,"Cp1252","windows-1252"),K.Cp1256=new K(z.Cp1256,24,"Cp1256","windows-1256"),K.UnicodeBigUnmarked=new K(z.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),K.UTF8=new K(z.UTF8,26,"UTF8","UTF-8"),K.ASCII=new K(z.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),K.Big5=new K(z.Big5,28,"Big5"),K.GB18030=new K(z.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),K.EUC_KR=new K(z.EUC_KR,30,"EUC_KR","EUC-KR");var Y=function(){function t(){Object(l.a)(this,t)}return Object(c.a)(t,[{key:"exp",value:function(t){return this.expTable[t]}},{key:"log",value:function(t){if(0===t)throw new G;return this.logTable[t]}}],[{key:"addOrSubtract",value:function(t,e){return t^e}}]),t}(),X=function(){function t(e,n){if(Object(l.a)(this,t),0===n.length)throw new G;this.field=e;var r=n.length;if(r>1&&0===n[0]){for(var i=1;i<r&&0===n[i];)i++;i===r?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(r-i),x.arraycopy(n,i,this.coefficients,0,this.coefficients.length))}else this.coefficients=n}return Object(c.a)(t,[{key:"getCoefficients",value:function(){return this.coefficients}},{key:"getDegree",value:function(){return this.coefficients.length-1}},{key:"isZero",value:function(){return 0===this.coefficients[0]}},{key:"getCoefficient",value:function(t){return this.coefficients[this.coefficients.length-1-t]}},{key:"evaluateAt",value:function(t){if(0===t)return this.getCoefficient(0);var e,n=this.coefficients;if(1===t){e=0;for(var r=0,i=n.length;r!==i;r++){var a=n[r];e=Y.addOrSubtract(e,a)}return e}e=n[0];for(var o=n.length,s=this.field,h=1;h<o;h++)e=Y.addOrSubtract(s.multiply(t,e),n[h]);return e}},{key:"addOrSubtract",value:function(e){if(!this.field.equals(e.field))throw new G("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;var n=this.coefficients,r=e.coefficients;if(n.length>r.length){var i=n;n=r,r=i}var a=new Int32Array(r.length),o=r.length-n.length;x.arraycopy(r,0,a,0,o);for(var s=o;s<r.length;s++)a[s]=Y.addOrSubtract(n[s-o],r[s]);return new t(this.field,a)}},{key:"multiply",value:function(e){if(!this.field.equals(e.field))throw new G("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();for(var n=this.coefficients,r=n.length,i=e.coefficients,a=i.length,o=new Int32Array(r+a-1),s=this.field,h=0;h<r;h++)for(var u=n[h],l=0;l<a;l++)o[h+l]=Y.addOrSubtract(o[h+l],s.multiply(u,i[l]));return new t(s,o)}},{key:"multiplyScalar",value:function(e){if(0===e)return this.field.getZero();if(1===e)return this;for(var n=this.coefficients.length,r=this.field,i=new Int32Array(n),a=this.coefficients,o=0;o<n;o++)i[o]=r.multiply(a[o],e);return new t(r,i)}},{key:"multiplyByMonomial",value:function(e,n){if(e<0)throw new G;if(0===n)return this.field.getZero();for(var r=this.coefficients,i=r.length,a=new Int32Array(i+e),o=this.field,s=0;s<i;s++)a[s]=o.multiply(r[s],n);return new t(o,a)}},{key:"divide",value:function(t){if(!this.field.equals(t.field))throw new G("GenericGFPolys do not have same GenericGF field");if(t.isZero())throw new G("Divide by 0");for(var e=this.field,n=e.getZero(),r=this,i=t.getCoefficient(t.getDegree()),a=e.inverse(i);r.getDegree()>=t.getDegree()&&!r.isZero();){var o=r.getDegree()-t.getDegree(),s=e.multiply(r.getCoefficient(r.getDegree()),a),h=t.multiplyByMonomial(o,s),u=e.buildMonomial(o,s);n=n.addOrSubtract(u),r=r.addOrSubtract(h)}return[n,r]}},{key:"toString",value:function(){for(var t="",e=this.getDegree();e>=0;e--){var n=this.getCoefficient(e);if(0!==n){if(n<0?(t+=" - ",n=-n):t.length>0&&(t+=" + "),0===e||1!==n){var r=this.field.log(n);0===r?t+="1":1===r?t+="a":(t+="a^",t+=r)}0!==e&&(1===e?t+="x":(t+="x^",t+=e))}}return t}}]),t}(),Q=function(t){Object(w.a)(n,t);var e=Object(v.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return n}(V),q=function(t){Object(w.a)(n,t);var e=Object(v.a)(n);function n(t,r,i){var a;Object(l.a)(this,n),(a=e.call(this)).primitive=t,a.size=r,a.generatorBase=i;for(var o=new Int32Array(r),s=1,h=0;h<r;h++)o[h]=s,(s*=2)>=r&&(s^=t,s&=r-1);a.expTable=o;for(var u=new Int32Array(r),c=0;c<r-1;c++)u[o[c]]=c;return a.logTable=u,a.zero=new X(Object(f.a)(a),Int32Array.from([0])),a.one=new X(Object(f.a)(a),Int32Array.from([1])),a}return Object(c.a)(n,[{key:"getZero",value:function(){return this.zero}},{key:"getOne",value:function(){return this.one}},{key:"buildMonomial",value:function(t,e){if(t<0)throw new G;if(0===e)return this.zero;var n=new Int32Array(t+1);return n[0]=e,new X(this,n)}},{key:"inverse",value:function(t){if(0===t)throw new Q;return this.expTable[this.size-this.logTable[t]-1]}},{key:"multiply",value:function(t,e){return 0===t||0===e?0:this.expTable[(this.logTable[t]+this.logTable[e])%(this.size-1)]}},{key:"getSize",value:function(){return this.size}},{key:"getGeneratorBase",value:function(){return this.generatorBase}},{key:"toString",value:function(){return"GF(0x"+j.toHexString(this.primitive)+","+this.size+")"}},{key:"equals",value:function(t){return t===this}}]),n}(Y);q.AZTEC_DATA_12=new q(4201,4096,1),q.AZTEC_DATA_10=new q(1033,1024,1),q.AZTEC_DATA_6=new q(67,64,1),q.AZTEC_PARAM=new q(19,16,1),q.QR_CODE_FIELD_256=new q(285,256,0),q.DATA_MATRIX_FIELD_256=new q(301,256,1),q.AZTEC_DATA_8=q.DATA_MATRIX_FIELD_256,q.MAXICODE_FIELD_64=q.AZTEC_DATA_6;var J,$=function(){function t(e){Object(l.a)(this,t),this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new X(e,Int32Array.from([1])))}return Object(c.a)(t,[{key:"buildGenerator",value:function(t){var e=this.cachedGenerators;if(t>=e.length)for(var n=e[e.length-1],r=this.field,i=e.length;i<=t;i++){var a=n.multiply(new X(r,Int32Array.from([1,r.exp(i-1+r.getGeneratorBase())])));e.push(a),n=a}return e[t]}},{key:"encode",value:function(t,e){if(0===e)throw new G("No error correction bytes");var n=t.length-e;if(n<=0)throw new G("No data bytes provided");var r=this.buildGenerator(e),i=new Int32Array(n);x.arraycopy(t,0,i,0,n);for(var a=new X(this.field,i),o=(a=a.multiplyByMonomial(e,1)).divide(r)[1].getCoefficients(),s=e-o.length,h=0;h<s;h++)t[n+h]=0;x.arraycopy(o,0,t,n+s,o.length)}}]),t}();!function(t){t[t.TERMINATOR=0]="TERMINATOR",t[t.NUMERIC=1]="NUMERIC",t[t.ALPHANUMERIC=2]="ALPHANUMERIC",t[t.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",t[t.BYTE=4]="BYTE",t[t.ECI=5]="ECI",t[t.KANJI=6]="KANJI",t[t.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",t[t.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",t[t.HANZI=9]="HANZI"}(J||(J={}));var tt=function(){function t(e,n,r,i){Object(l.a)(this,t),this.value=e,this.stringValue=n,this.characterCountBitsForVersions=r,this.bits=i,t.FOR_BITS.set(i,this),t.FOR_VALUE.set(e,this)}return Object(c.a)(t,[{key:"getCharacterCountBits",value:function(t){var e,n=t.getVersionNumber();return e=n<=9?0:n<=26?1:2,this.characterCountBitsForVersions[e]}},{key:"getValue",value:function(){return this.value}},{key:"getBits",value:function(){return this.bits}},{key:"equals",value:function(e){if(!(e instanceof t))return!1;var n=e;return this.value===n.value}},{key:"toString",value:function(){return this.stringValue}}],[{key:"forBits",value:function(e){var n=t.FOR_BITS.get(e);if(void 0===n)throw new G;return n}}]),t}();tt.FOR_BITS=new Map,tt.FOR_VALUE=new Map,tt.TERMINATOR=new tt(J.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),tt.NUMERIC=new tt(J.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),tt.ALPHANUMERIC=new tt(J.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),tt.STRUCTURED_APPEND=new tt(J.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),tt.BYTE=new tt(J.BYTE,"BYTE",Int32Array.from([8,16,16]),4),tt.ECI=new tt(J.ECI,"ECI",Int32Array.from([0,0,0]),7),tt.KANJI=new tt(J.KANJI,"KANJI",Int32Array.from([8,10,12]),8),tt.FNC1_FIRST_POSITION=new tt(J.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),tt.FNC1_SECOND_POSITION=new tt(J.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),tt.HANZI=new tt(J.HANZI,"HANZI",Int32Array.from([8,10,12]),13);var et,nt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";Object(l.a)(this,t),this.value=e}return Object(c.a)(t,[{key:"append",value:function(t){return this.value+="string"===typeof t?t.toString():String.fromCharCode(t),this}},{key:"length",value:function(){return this.value.length}},{key:"charAt",value:function(t){return this.value.charAt(t)}},{key:"deleteCharAt",value:function(t){this.value=this.value.substr(0,t)+this.value.substring(t+1)}},{key:"setCharAt",value:function(t,e){this.value=this.value.substr(0,t)+e+this.value.substr(t+1)}},{key:"substring",value:function(t,e){return this.value.substring(t,e)}},{key:"toString",value:function(){return this.value}},{key:"insert",value:function(t,e){this.value=this.value.substr(0,t)+e+this.value.substr(t+e.length)}}]),t}(),rt=function(){function t(e,n,r,i){if(Object(l.a)(this,t),this.width=e,this.height=n,this.rowSize=r,this.bits=i,void 0!==n&&null!==n||(n=e),this.height=n,e<1||n<1)throw new G("Both dimensions must be greater than 0");void 0!==r&&null!==r||(r=Math.floor((e+31)/32)),this.rowSize=r,void 0!==i&&null!==i||(this.bits=new Int32Array(this.rowSize*this.height))}return Object(c.a)(t,[{key:"get",value:function(t,e){var n=e*this.rowSize+Math.floor(t/32);return 0!==(this.bits[n]>>>(31&t)&1)}},{key:"set",value:function(t,e){var n=e*this.rowSize+Math.floor(t/32);this.bits[n]|=1<<(31&t)&4294967295}},{key:"unset",value:function(t,e){var n=e*this.rowSize+Math.floor(t/32);this.bits[n]&=~(1<<(31&t)&4294967295)}},{key:"flip",value:function(t,e){var n=e*this.rowSize+Math.floor(t/32);this.bits[n]^=1<<(31&t)&4294967295}},{key:"xor",value:function(t){if(this.width!==t.getWidth()||this.height!==t.getHeight()||this.rowSize!==t.getRowSize())throw new G("input matrix dimensions do not match");for(var e=new W(Math.floor(this.width/32)+1),n=this.rowSize,r=this.bits,i=0,a=this.height;i<a;i++)for(var o=i*n,s=t.getRow(i,e).getBitArray(),h=0;h<n;h++)r[o+h]^=s[h]}},{key:"clear",value:function(){for(var t=this.bits,e=t.length,n=0;n<e;n++)t[n]=0}},{key:"setRegion",value:function(t,e,n,r){if(e<0||t<0)throw new G("Left and top must be nonnegative");if(r<1||n<1)throw new G("Height and width must be at least 1");var i=t+n,a=e+r;if(a>this.height||i>this.width)throw new G("The region must fit inside the matrix");for(var o=this.rowSize,s=this.bits,h=e;h<a;h++)for(var u=h*o,l=t;l<i;l++)s[u+Math.floor(l/32)]|=1<<(31&l)&4294967295}},{key:"getRow",value:function(t,e){null===e||void 0===e||e.getSize()<this.width?e=new W(this.width):e.clear();for(var n=this.rowSize,r=this.bits,i=t*n,a=0;a<n;a++)e.setBulk(32*a,r[i+a]);return e}},{key:"setRow",value:function(t,e){x.arraycopy(e.getBitArray(),0,this.bits,t*this.rowSize,this.rowSize)}},{key:"rotate180",value:function(){for(var t=this.getWidth(),e=this.getHeight(),n=new W(t),r=new W(t),i=0,a=Math.floor((e+1)/2);i<a;i++)n=this.getRow(i,n),r=this.getRow(e-1-i,r),n.reverse(),r.reverse(),this.setRow(i,r),this.setRow(e-1-i,n)}},{key:"getEnclosingRectangle",value:function(){for(var t=this.width,e=this.height,n=this.rowSize,r=this.bits,i=t,a=e,o=-1,s=-1,h=0;h<e;h++)for(var u=0;u<n;u++){var l=r[h*n+u];if(0!==l){if(h<a&&(a=h),h>s&&(s=h),32*u<i){for(var c=0;0===(l<<31-c&4294967295);)c++;32*u+c<i&&(i=32*u+c)}if(32*u+31>o){for(var f=31;l>>>f===0;)f--;32*u+f>o&&(o=32*u+f)}}}return o<i||s<a?null:Int32Array.from([i,a,o-i+1,s-a+1])}},{key:"getTopLeftOnBit",value:function(){for(var t=this.rowSize,e=this.bits,n=0;n<e.length&&0===e[n];)n++;if(n===e.length)return null;for(var r=n/t,i=n%t*32,a=e[n],o=0;0===(a<<31-o&4294967295);)o++;return i+=o,Int32Array.from([i,r])}},{key:"getBottomRightOnBit",value:function(){for(var t=this.rowSize,e=this.bits,n=e.length-1;n>=0&&0===e[n];)n--;if(n<0)return null;for(var r=Math.floor(n/t),i=32*Math.floor(n%t),a=e[n],o=31;a>>>o===0;)o--;return i+=o,Int32Array.from([i,r])}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getRowSize",value:function(){return this.rowSize}},{key:"equals",value:function(e){if(!(e instanceof t))return!1;var n=e;return this.width===n.width&&this.height===n.height&&this.rowSize===n.rowSize&&H.equals(this.bits,n.bits)}},{key:"hashCode",value:function(){var t=this.width;return t=31*(t=31*(t=31*(t=31*t+this.width)+this.height)+this.rowSize)+H.hashCode(this.bits)}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"x",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"\n";return this.buildToString(t,e,n)}},{key:"buildToString",value:function(t,e,n){var r=new nt;r.append(n);for(var i=0,a=this.height;i<a;i++){for(var o=0,s=this.width;o<s;o++)r.append(this.get(o,i)?t:e);r.append(n)}return r.toString()}},{key:"clone",value:function(){return new t(this.width,this.height,this.rowSize,this.bits.slice())}}],[{key:"parseFromBooleanArray",value:function(e){for(var n=e.length,r=e[0].length,i=new t(r,n),a=0;a<n;a++)for(var o=e[a],s=0;s<r;s++)o[s]&&i.set(s,a);return i}},{key:"parseFromString",value:function(e,n,r){if(null===e)throw new G("stringRepresentation cannot be null");for(var i=new Array(e.length),a=0,o=0,s=-1,h=0,u=0;u<e.length;)if("\n"===e.charAt(u)||"\r"===e.charAt(u)){if(a>o){if(-1===s)s=a-o;else if(a-o!==s)throw new G("row lengths do not match");o=a,h++}u++}else if(e.substring(u,u+n.length)===n)u+=n.length,i[a]=!0,a++;else{if(e.substring(u,u+r.length)!==r)throw new G("illegal character encountered: "+e.substring(u));u+=r.length,i[a]=!1,a++}if(a>o){if(-1===s)s=a-o;else if(a-o!==s)throw new G("row lengths do not match");h++}for(var l=new t(s,h),c=0;c<a;c++)i[c]&&l.set(Math.floor(c%s),Math.floor(c/s));return l}}]),t}(),it=function(t){Object(w.a)(n,t);var e=Object(v.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return n}(V);!function(t){t[t.L=0]="L",t[t.M=1]="M",t[t.Q=2]="Q",t[t.H=3]="H"}(et||(et={}));var at=function(){function t(e,n,r){Object(l.a)(this,t),this.value=e,this.stringValue=n,this.bits=r,t.FOR_BITS.set(r,this),t.FOR_VALUE.set(e,this)}return Object(c.a)(t,[{key:"getValue",value:function(){return this.value}},{key:"getBits",value:function(){return this.bits}},{key:"toString",value:function(){return this.stringValue}},{key:"equals",value:function(e){if(!(e instanceof t))return!1;var n=e;return this.value===n.value}}],[{key:"fromString",value:function(e){switch(e){case"L":return t.L;case"M":return t.M;case"Q":return t.Q;case"H":return t.H;default:throw new it(e+"not available")}}},{key:"forBits",value:function(e){if(e<0||e>=t.FOR_BITS.size)throw new G;return t.FOR_BITS.get(e)}}]),t}();at.FOR_BITS=new Map,at.FOR_VALUE=new Map,at.L=new at(et.L,"L",1),at.M=new at(et.M,"M",0),at.Q=new at(et.Q,"Q",3),at.H=new at(et.H,"H",2);var ot=function(){function t(e){Object(l.a)(this,t),this.errorCorrectionLevel=at.forBits(e>>3&3),this.dataMask=7&e}return Object(c.a)(t,[{key:"getErrorCorrectionLevel",value:function(){return this.errorCorrectionLevel}},{key:"getDataMask",value:function(){return this.dataMask}},{key:"hashCode",value:function(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}},{key:"equals",value:function(e){if(!(e instanceof t))return!1;var n=e;return this.errorCorrectionLevel===n.errorCorrectionLevel&&this.dataMask===n.dataMask}}],[{key:"numBitsDiffering",value:function(t,e){return j.bitCount(t^e)}},{key:"decodeFormatInformation",value:function(e,n){var r=t.doDecodeFormatInformation(e,n);return null!==r?r:t.doDecodeFormatInformation(e^t.FORMAT_INFO_MASK_QR,n^t.FORMAT_INFO_MASK_QR)}},{key:"doDecodeFormatInformation",value:function(e,n){var r,i=Number.MAX_SAFE_INTEGER,a=0,o=Object(k.a)(t.FORMAT_INFO_DECODE_LOOKUP);try{for(o.s();!(r=o.n()).done;){var s=r.value,h=s[0];if(h===e||h===n)return new t(s[1]);var u=t.numBitsDiffering(e,h);u<i&&(a=s[1],i=u),e!==n&&(u=t.numBitsDiffering(n,h))<i&&(a=s[1],i=u)}}catch(l){o.e(l)}finally{o.f()}return i<=3?new t(a):null}}]),t}();ot.FORMAT_INFO_MASK_QR=21522,ot.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];var st=function(){function t(e){Object(l.a)(this,t),this.ecCodewordsPerBlock=e;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.ecBlocks=r}return Object(c.a)(t,[{key:"getECCodewordsPerBlock",value:function(){return this.ecCodewordsPerBlock}},{key:"getNumBlocks",value:function(){var t,e=0,n=this.ecBlocks,r=Object(k.a)(n);try{for(r.s();!(t=r.n()).done;){e+=t.value.getCount()}}catch(i){r.e(i)}finally{r.f()}return e}},{key:"getTotalECCodewords",value:function(){return this.ecCodewordsPerBlock*this.getNumBlocks()}},{key:"getECBlocks",value:function(){return this.ecBlocks}}]),t}(),ht=function(){function t(e,n){Object(l.a)(this,t),this.count=e,this.dataCodewords=n}return Object(c.a)(t,[{key:"getCount",value:function(){return this.count}},{key:"getDataCodewords",value:function(){return this.dataCodewords}}]),t}(),ut=function(){function t(e,n){Object(l.a)(this,t),this.versionNumber=e,this.alignmentPatternCenters=n;for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];this.ecBlocks=i;var o,s=0,h=i[0].getECCodewordsPerBlock(),u=i[0].getECBlocks(),c=Object(k.a)(u);try{for(c.s();!(o=c.n()).done;){var f=o.value;s+=f.getCount()*(f.getDataCodewords()+h)}}catch(v){c.e(v)}finally{c.f()}this.totalCodewords=s}return Object(c.a)(t,[{key:"getVersionNumber",value:function(){return this.versionNumber}},{key:"getAlignmentPatternCenters",value:function(){return this.alignmentPatternCenters}},{key:"getTotalCodewords",value:function(){return this.totalCodewords}},{key:"getDimensionForVersion",value:function(){return 17+4*this.versionNumber}},{key:"getECBlocksForLevel",value:function(t){return this.ecBlocks[t.getValue()]}},{key:"buildFunctionPattern",value:function(){var t=this.getDimensionForVersion(),e=new rt(t);e.setRegion(0,0,9,9),e.setRegion(t-8,0,8,9),e.setRegion(0,t-8,9,8);for(var n=this.alignmentPatternCenters.length,r=0;r<n;r++)for(var i=this.alignmentPatternCenters[r]-2,a=0;a<n;a++)0===r&&(0===a||a===n-1)||r===n-1&&0===a||e.setRegion(this.alignmentPatternCenters[a]-2,i,5,5);return e.setRegion(6,9,1,t-17),e.setRegion(9,6,t-17,1),this.versionNumber>6&&(e.setRegion(t-11,0,3,6),e.setRegion(0,t-11,6,3)),e}},{key:"toString",value:function(){return""+this.versionNumber}}],[{key:"getProvisionalVersionForDimension",value:function(t){if(t%4!==1)throw new Z;try{return this.getVersionForNumber((t-17)/4)}catch(e){throw new Z}}},{key:"getVersionForNumber",value:function(e){if(e<1||e>40)throw new G;return t.VERSIONS[e-1]}},{key:"decodeVersionInformation",value:function(e){for(var n=Number.MAX_SAFE_INTEGER,r=0,i=0;i<t.VERSION_DECODE_INFO.length;i++){var a=t.VERSION_DECODE_INFO[i];if(a===e)return t.getVersionForNumber(i+7);var o=ot.numBitsDiffering(e,a);o<n&&(r=i+7,n=o)}return n<=3?t.getVersionForNumber(r):null}}]),t}();ut.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),ut.VERSIONS=[new ut(1,new Int32Array(0),new st(7,new ht(1,19)),new st(10,new ht(1,16)),new st(13,new ht(1,13)),new st(17,new ht(1,9))),new ut(2,Int32Array.from([6,18]),new st(10,new ht(1,34)),new st(16,new ht(1,28)),new st(22,new ht(1,22)),new st(28,new ht(1,16))),new ut(3,Int32Array.from([6,22]),new st(15,new ht(1,55)),new st(26,new ht(1,44)),new st(18,new ht(2,17)),new st(22,new ht(2,13))),new ut(4,Int32Array.from([6,26]),new st(20,new ht(1,80)),new st(18,new ht(2,32)),new st(26,new ht(2,24)),new st(16,new ht(4,9))),new ut(5,Int32Array.from([6,30]),new st(26,new ht(1,108)),new st(24,new ht(2,43)),new st(18,new ht(2,15),new ht(2,16)),new st(22,new ht(2,11),new ht(2,12))),new ut(6,Int32Array.from([6,34]),new st(18,new ht(2,68)),new st(16,new ht(4,27)),new st(24,new ht(4,19)),new st(28,new ht(4,15))),new ut(7,Int32Array.from([6,22,38]),new st(20,new ht(2,78)),new st(18,new ht(4,31)),new st(18,new ht(2,14),new ht(4,15)),new st(26,new ht(4,13),new ht(1,14))),new ut(8,Int32Array.from([6,24,42]),new st(24,new ht(2,97)),new st(22,new ht(2,38),new ht(2,39)),new st(22,new ht(4,18),new ht(2,19)),new st(26,new ht(4,14),new ht(2,15))),new ut(9,Int32Array.from([6,26,46]),new st(30,new ht(2,116)),new st(22,new ht(3,36),new ht(2,37)),new st(20,new ht(4,16),new ht(4,17)),new st(24,new ht(4,12),new ht(4,13))),new ut(10,Int32Array.from([6,28,50]),new st(18,new ht(2,68),new ht(2,69)),new st(26,new ht(4,43),new ht(1,44)),new st(24,new ht(6,19),new ht(2,20)),new st(28,new ht(6,15),new ht(2,16))),new ut(11,Int32Array.from([6,30,54]),new st(20,new ht(4,81)),new st(30,new ht(1,50),new ht(4,51)),new st(28,new ht(4,22),new ht(4,23)),new st(24,new ht(3,12),new ht(8,13))),new ut(12,Int32Array.from([6,32,58]),new st(24,new ht(2,92),new ht(2,93)),new st(22,new ht(6,36),new ht(2,37)),new st(26,new ht(4,20),new ht(6,21)),new st(28,new ht(7,14),new ht(4,15))),new ut(13,Int32Array.from([6,34,62]),new st(26,new ht(4,107)),new st(22,new ht(8,37),new ht(1,38)),new st(24,new ht(8,20),new ht(4,21)),new st(22,new ht(12,11),new ht(4,12))),new ut(14,Int32Array.from([6,26,46,66]),new st(30,new ht(3,115),new ht(1,116)),new st(24,new ht(4,40),new ht(5,41)),new st(20,new ht(11,16),new ht(5,17)),new st(24,new ht(11,12),new ht(5,13))),new ut(15,Int32Array.from([6,26,48,70]),new st(22,new ht(5,87),new ht(1,88)),new st(24,new ht(5,41),new ht(5,42)),new st(30,new ht(5,24),new ht(7,25)),new st(24,new ht(11,12),new ht(7,13))),new ut(16,Int32Array.from([6,26,50,74]),new st(24,new ht(5,98),new ht(1,99)),new st(28,new ht(7,45),new ht(3,46)),new st(24,new ht(15,19),new ht(2,20)),new st(30,new ht(3,15),new ht(13,16))),new ut(17,Int32Array.from([6,30,54,78]),new st(28,new ht(1,107),new ht(5,108)),new st(28,new ht(10,46),new ht(1,47)),new st(28,new ht(1,22),new ht(15,23)),new st(28,new ht(2,14),new ht(17,15))),new ut(18,Int32Array.from([6,30,56,82]),new st(30,new ht(5,120),new ht(1,121)),new st(26,new ht(9,43),new ht(4,44)),new st(28,new ht(17,22),new ht(1,23)),new st(28,new ht(2,14),new ht(19,15))),new ut(19,Int32Array.from([6,30,58,86]),new st(28,new ht(3,113),new ht(4,114)),new st(26,new ht(3,44),new ht(11,45)),new st(26,new ht(17,21),new ht(4,22)),new st(26,new ht(9,13),new ht(16,14))),new ut(20,Int32Array.from([6,34,62,90]),new st(28,new ht(3,107),new ht(5,108)),new st(26,new ht(3,41),new ht(13,42)),new st(30,new ht(15,24),new ht(5,25)),new st(28,new ht(15,15),new ht(10,16))),new ut(21,Int32Array.from([6,28,50,72,94]),new st(28,new ht(4,116),new ht(4,117)),new st(26,new ht(17,42)),new st(28,new ht(17,22),new ht(6,23)),new st(30,new ht(19,16),new ht(6,17))),new ut(22,Int32Array.from([6,26,50,74,98]),new st(28,new ht(2,111),new ht(7,112)),new st(28,new ht(17,46)),new st(30,new ht(7,24),new ht(16,25)),new st(24,new ht(34,13))),new ut(23,Int32Array.from([6,30,54,78,102]),new st(30,new ht(4,121),new ht(5,122)),new st(28,new ht(4,47),new ht(14,48)),new st(30,new ht(11,24),new ht(14,25)),new st(30,new ht(16,15),new ht(14,16))),new ut(24,Int32Array.from([6,28,54,80,106]),new st(30,new ht(6,117),new ht(4,118)),new st(28,new ht(6,45),new ht(14,46)),new st(30,new ht(11,24),new ht(16,25)),new st(30,new ht(30,16),new ht(2,17))),new ut(25,Int32Array.from([6,32,58,84,110]),new st(26,new ht(8,106),new ht(4,107)),new st(28,new ht(8,47),new ht(13,48)),new st(30,new ht(7,24),new ht(22,25)),new st(30,new ht(22,15),new ht(13,16))),new ut(26,Int32Array.from([6,30,58,86,114]),new st(28,new ht(10,114),new ht(2,115)),new st(28,new ht(19,46),new ht(4,47)),new st(28,new ht(28,22),new ht(6,23)),new st(30,new ht(33,16),new ht(4,17))),new ut(27,Int32Array.from([6,34,62,90,118]),new st(30,new ht(8,122),new ht(4,123)),new st(28,new ht(22,45),new ht(3,46)),new st(30,new ht(8,23),new ht(26,24)),new st(30,new ht(12,15),new ht(28,16))),new ut(28,Int32Array.from([6,26,50,74,98,122]),new st(30,new ht(3,117),new ht(10,118)),new st(28,new ht(3,45),new ht(23,46)),new st(30,new ht(4,24),new ht(31,25)),new st(30,new ht(11,15),new ht(31,16))),new ut(29,Int32Array.from([6,30,54,78,102,126]),new st(30,new ht(7,116),new ht(7,117)),new st(28,new ht(21,45),new ht(7,46)),new st(30,new ht(1,23),new ht(37,24)),new st(30,new ht(19,15),new ht(26,16))),new ut(30,Int32Array.from([6,26,52,78,104,130]),new st(30,new ht(5,115),new ht(10,116)),new st(28,new ht(19,47),new ht(10,48)),new st(30,new ht(15,24),new ht(25,25)),new st(30,new ht(23,15),new ht(25,16))),new ut(31,Int32Array.from([6,30,56,82,108,134]),new st(30,new ht(13,115),new ht(3,116)),new st(28,new ht(2,46),new ht(29,47)),new st(30,new ht(42,24),new ht(1,25)),new st(30,new ht(23,15),new ht(28,16))),new ut(32,Int32Array.from([6,34,60,86,112,138]),new st(30,new ht(17,115)),new st(28,new ht(10,46),new ht(23,47)),new st(30,new ht(10,24),new ht(35,25)),new st(30,new ht(19,15),new ht(35,16))),new ut(33,Int32Array.from([6,30,58,86,114,142]),new st(30,new ht(17,115),new ht(1,116)),new st(28,new ht(14,46),new ht(21,47)),new st(30,new ht(29,24),new ht(19,25)),new st(30,new ht(11,15),new ht(46,16))),new ut(34,Int32Array.from([6,34,62,90,118,146]),new st(30,new ht(13,115),new ht(6,116)),new st(28,new ht(14,46),new ht(23,47)),new st(30,new ht(44,24),new ht(7,25)),new st(30,new ht(59,16),new ht(1,17))),new ut(35,Int32Array.from([6,30,54,78,102,126,150]),new st(30,new ht(12,121),new ht(7,122)),new st(28,new ht(12,47),new ht(26,48)),new st(30,new ht(39,24),new ht(14,25)),new st(30,new ht(22,15),new ht(41,16))),new ut(36,Int32Array.from([6,24,50,76,102,128,154]),new st(30,new ht(6,121),new ht(14,122)),new st(28,new ht(6,47),new ht(34,48)),new st(30,new ht(46,24),new ht(10,25)),new st(30,new ht(2,15),new ht(64,16))),new ut(37,Int32Array.from([6,28,54,80,106,132,158]),new st(30,new ht(17,122),new ht(4,123)),new st(28,new ht(29,46),new ht(14,47)),new st(30,new ht(49,24),new ht(10,25)),new st(30,new ht(24,15),new ht(46,16))),new ut(38,Int32Array.from([6,32,58,84,110,136,162]),new st(30,new ht(4,122),new ht(18,123)),new st(28,new ht(13,46),new ht(32,47)),new st(30,new ht(48,24),new ht(14,25)),new st(30,new ht(42,15),new ht(32,16))),new ut(39,Int32Array.from([6,26,54,82,110,138,166]),new st(30,new ht(20,117),new ht(4,118)),new st(28,new ht(40,47),new ht(7,48)),new st(30,new ht(43,24),new ht(22,25)),new st(30,new ht(10,15),new ht(67,16))),new ut(40,Int32Array.from([6,30,58,86,114,142,170]),new st(30,new ht(19,118),new ht(6,119)),new st(28,new ht(18,47),new ht(31,48)),new st(30,new ht(34,24),new ht(34,25)),new st(30,new ht(20,15),new ht(61,16)))];var lt=function(){function t(){Object(l.a)(this,t)}return Object(c.a)(t,null,[{key:"applyMaskPenaltyRule1",value:function(e){return t.applyMaskPenaltyRule1Internal(e,!0)+t.applyMaskPenaltyRule1Internal(e,!1)}},{key:"applyMaskPenaltyRule2",value:function(e){for(var n=0,r=e.getArray(),i=e.getWidth(),a=e.getHeight(),o=0;o<a-1;o++)for(var s=r[o],h=0;h<i-1;h++){var u=s[h];u===s[h+1]&&u===r[o+1][h]&&u===r[o+1][h+1]&&n++}return t.N2*n}},{key:"applyMaskPenaltyRule3",value:function(e){for(var n=0,r=e.getArray(),i=e.getWidth(),a=e.getHeight(),o=0;o<a;o++)for(var s=0;s<i;s++){var h=r[o];s+6<i&&1===h[s]&&0===h[s+1]&&1===h[s+2]&&1===h[s+3]&&1===h[s+4]&&0===h[s+5]&&1===h[s+6]&&(t.isWhiteHorizontal(h,s-4,s)||t.isWhiteHorizontal(h,s+7,s+11))&&n++,o+6<a&&1===r[o][s]&&0===r[o+1][s]&&1===r[o+2][s]&&1===r[o+3][s]&&1===r[o+4][s]&&0===r[o+5][s]&&1===r[o+6][s]&&(t.isWhiteVertical(r,s,o-4,o)||t.isWhiteVertical(r,s,o+7,o+11))&&n++}return n*t.N3}},{key:"isWhiteHorizontal",value:function(t,e,n){e=Math.max(e,0),n=Math.min(n,t.length);for(var r=e;r<n;r++)if(1===t[r])return!1;return!0}},{key:"isWhiteVertical",value:function(t,e,n,r){n=Math.max(n,0),r=Math.min(r,t.length);for(var i=n;i<r;i++)if(1===t[i][e])return!1;return!0}},{key:"applyMaskPenaltyRule4",value:function(e){for(var n=0,r=e.getArray(),i=e.getWidth(),a=e.getHeight(),o=0;o<a;o++)for(var s=r[o],h=0;h<i;h++)1===s[h]&&n++;var u=e.getHeight()*e.getWidth();return Math.floor(10*Math.abs(2*n-u)/u)*t.N4}},{key:"getDataMaskBit",value:function(t,e,n){var r,i;switch(t){case 0:r=n+e&1;break;case 1:r=1&n;break;case 2:r=e%3;break;case 3:r=(n+e)%3;break;case 4:r=Math.floor(n/2)+Math.floor(e/3)&1;break;case 5:r=(1&(i=n*e))+i%3;break;case 6:r=(1&(i=n*e))+i%3&1;break;case 7:r=(i=n*e)%3+(n+e&1)&1;break;default:throw new G("Invalid mask pattern: "+t)}return 0===r}},{key:"applyMaskPenaltyRule1Internal",value:function(e,n){for(var r=0,i=n?e.getHeight():e.getWidth(),a=n?e.getWidth():e.getHeight(),o=e.getArray(),s=0;s<i;s++){for(var h=0,u=-1,l=0;l<a;l++){var c=n?o[s][l]:o[l][s];c===u?h++:(h>=5&&(r+=t.N1+(h-5)),h=1,u=c)}h>=5&&(r+=t.N1+(h-5))}return r}}]),t}();lt.N1=3,lt.N2=3,lt.N3=40,lt.N4=10;var ct=function(){function t(e,n){Object(l.a)(this,t),this.width=e,this.height=n;for(var r=new Array(n),i=0;i!==n;i++)r[i]=new Uint8Array(e);this.bytes=r}return Object(c.a)(t,[{key:"getHeight",value:function(){return this.height}},{key:"getWidth",value:function(){return this.width}},{key:"get",value:function(t,e){return this.bytes[e][t]}},{key:"getArray",value:function(){return this.bytes}},{key:"setNumber",value:function(t,e,n){this.bytes[e][t]=n}},{key:"setBoolean",value:function(t,e,n){this.bytes[e][t]=n?1:0}},{key:"clear",value:function(t){var e,n=Object(k.a)(this.bytes);try{for(n.s();!(e=n.n()).done;){var r=e.value;H.fill(r,t)}}catch(i){n.e(i)}finally{n.f()}}},{key:"equals",value:function(e){if(!(e instanceof t))return!1;var n=e;if(this.width!==n.width)return!1;if(this.height!==n.height)return!1;for(var r=0,i=this.height;r<i;++r)for(var a=this.bytes[r],o=n.bytes[r],s=0,h=this.width;s<h;++s)if(a[s]!==o[s])return!1;return!0}},{key:"toString",value:function(){for(var t=new nt,e=0,n=this.height;e<n;++e){for(var r=this.bytes[e],i=0,a=this.width;i<a;++i)switch(r[i]){case 0:t.append(" 0");break;case 1:t.append(" 1");break;default:t.append("  ")}t.append("\n")}return t.toString()}}]),t}(),ft=function(){function t(){Object(l.a)(this,t),this.maskPattern=-1}return Object(c.a)(t,[{key:"getMode",value:function(){return this.mode}},{key:"getECLevel",value:function(){return this.ecLevel}},{key:"getVersion",value:function(){return this.version}},{key:"getMaskPattern",value:function(){return this.maskPattern}},{key:"getMatrix",value:function(){return this.matrix}},{key:"toString",value:function(){var t=new nt;return t.append("<<\n"),t.append(" mode: "),t.append(this.mode?this.mode.toString():"null"),t.append("\n ecLevel: "),t.append(this.ecLevel?this.ecLevel.toString():"null"),t.append("\n version: "),t.append(this.version?this.version.toString():"null"),t.append("\n maskPattern: "),t.append(this.maskPattern.toString()),this.matrix?(t.append("\n matrix:\n"),t.append(this.matrix.toString())):t.append("\n matrix: null\n"),t.append(">>\n"),t.toString()}},{key:"setMode",value:function(t){this.mode=t}},{key:"setECLevel",value:function(t){this.ecLevel=t}},{key:"setVersion",value:function(t){this.version=t}},{key:"setMaskPattern",value:function(t){this.maskPattern=t}},{key:"setMatrix",value:function(t){this.matrix=t}}],[{key:"isValidMaskPattern",value:function(e){return e>=0&&e<t.NUM_MASK_PATTERNS}}]),t}();ft.NUM_MASK_PATTERNS=8;var vt=function(t){Object(w.a)(n,t);var e=Object(v.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return n}(V),wt=function(){function t(){Object(l.a)(this,t)}return Object(c.a)(t,null,[{key:"clearMatrix",value:function(t){t.clear(255)}},{key:"buildMatrix",value:function(e,n,r,i,a){t.clearMatrix(a),t.embedBasicPatterns(r,a),t.embedTypeInfo(n,i,a),t.maybeEmbedVersionInfo(r,a),t.embedDataBits(e,i,a)}},{key:"embedBasicPatterns",value:function(e,n){t.embedPositionDetectionPatternsAndSeparators(n),t.embedDarkDotAtLeftBottomCorner(n),t.maybeEmbedPositionAdjustmentPatterns(e,n),t.embedTimingPatterns(n)}},{key:"embedTypeInfo",value:function(e,n,r){var i=new W;t.makeTypeInfoBits(e,n,i);for(var a=0,o=i.getSize();a<o;++a){var s=i.get(i.getSize()-1-a),h=t.TYPE_INFO_COORDINATES[a],u=h[0],l=h[1];if(r.setBoolean(u,l,s),a<8){var c=r.getWidth()-a-1;r.setBoolean(c,8,s)}else{var f=r.getHeight()-7+(a-8);r.setBoolean(8,f,s)}}}},{key:"maybeEmbedVersionInfo",value:function(e,n){if(!(e.getVersionNumber()<7)){var r=new W;t.makeVersionInfoBits(e,r);for(var i=17,a=0;a<6;++a)for(var o=0;o<3;++o){var s=r.get(i);i--,n.setBoolean(a,n.getHeight()-11+o,s),n.setBoolean(n.getHeight()-11+o,a,s)}}}},{key:"embedDataBits",value:function(e,n,r){for(var i=0,a=-1,o=r.getWidth()-1,s=r.getHeight()-1;o>0;){for(6===o&&(o-=1);s>=0&&s<r.getHeight();){for(var h=0;h<2;++h){var u=o-h;if(t.isEmpty(r.get(u,s))){var l=void 0;i<e.getSize()?(l=e.get(i),++i):l=!1,255!==n&&lt.getDataMaskBit(n,u,s)&&(l=!l),r.setBoolean(u,s,l)}}s+=a}s+=a=-a,o-=2}if(i!==e.getSize())throw new vt("Not all bits consumed: "+i+"/"+e.getSize())}},{key:"findMSBSet",value:function(t){return 32-j.numberOfLeadingZeros(t)}},{key:"calculateBCHCode",value:function(e,n){if(0===n)throw new G("0 polynomial");var r=t.findMSBSet(n);for(e<<=r-1;t.findMSBSet(e)>=r;)e^=n<<t.findMSBSet(e)-r;return e}},{key:"makeTypeInfoBits",value:function(e,n,r){if(!ft.isValidMaskPattern(n))throw new vt("Invalid mask pattern");var i=e.getBits()<<3|n;r.appendBits(i,5);var a=t.calculateBCHCode(i,t.TYPE_INFO_POLY);r.appendBits(a,10);var o=new W;if(o.appendBits(t.TYPE_INFO_MASK_PATTERN,15),r.xor(o),15!==r.getSize())throw new vt("should not happen but we got: "+r.getSize())}},{key:"makeVersionInfoBits",value:function(e,n){n.appendBits(e.getVersionNumber(),6);var r=t.calculateBCHCode(e.getVersionNumber(),t.VERSION_INFO_POLY);if(n.appendBits(r,12),18!==n.getSize())throw new vt("should not happen but we got: "+n.getSize())}},{key:"isEmpty",value:function(t){return 255===t}},{key:"embedTimingPatterns",value:function(e){for(var n=8;n<e.getWidth()-8;++n){var r=(n+1)%2;t.isEmpty(e.get(n,6))&&e.setNumber(n,6,r),t.isEmpty(e.get(6,n))&&e.setNumber(6,n,r)}}},{key:"embedDarkDotAtLeftBottomCorner",value:function(t){if(0===t.get(8,t.getHeight()-8))throw new vt;t.setNumber(8,t.getHeight()-8,1)}},{key:"embedHorizontalSeparationPattern",value:function(e,n,r){for(var i=0;i<8;++i){if(!t.isEmpty(r.get(e+i,n)))throw new vt;r.setNumber(e+i,n,0)}}},{key:"embedVerticalSeparationPattern",value:function(e,n,r){for(var i=0;i<7;++i){if(!t.isEmpty(r.get(e,n+i)))throw new vt;r.setNumber(e,n+i,0)}}},{key:"embedPositionAdjustmentPattern",value:function(e,n,r){for(var i=0;i<5;++i)for(var a=t.POSITION_ADJUSTMENT_PATTERN[i],o=0;o<5;++o)r.setNumber(e+o,n+i,a[o])}},{key:"embedPositionDetectionPattern",value:function(e,n,r){for(var i=0;i<7;++i)for(var a=t.POSITION_DETECTION_PATTERN[i],o=0;o<7;++o)r.setNumber(e+o,n+i,a[o])}},{key:"embedPositionDetectionPatternsAndSeparators",value:function(e){var n=t.POSITION_DETECTION_PATTERN[0].length;t.embedPositionDetectionPattern(0,0,e),t.embedPositionDetectionPattern(e.getWidth()-n,0,e),t.embedPositionDetectionPattern(0,e.getWidth()-n,e);t.embedHorizontalSeparationPattern(0,7,e),t.embedHorizontalSeparationPattern(e.getWidth()-8,7,e),t.embedHorizontalSeparationPattern(0,e.getWidth()-8,e);t.embedVerticalSeparationPattern(7,0,e),t.embedVerticalSeparationPattern(e.getHeight()-7-1,0,e),t.embedVerticalSeparationPattern(7,e.getHeight()-7,e)}},{key:"maybeEmbedPositionAdjustmentPatterns",value:function(e,n){if(!(e.getVersionNumber()<2))for(var r=e.getVersionNumber()-1,i=t.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[r],a=0,o=i.length;a!==o;a++){var s=i[a];if(s>=0)for(var h=0;h!==o;h++){var u=i[h];u>=0&&t.isEmpty(n.get(u,s))&&t.embedPositionAdjustmentPattern(u-2,s-2,n)}}}}]),t}();wt.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),wt.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),wt.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),wt.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),wt.VERSION_INFO_POLY=7973,wt.TYPE_INFO_POLY=1335,wt.TYPE_INFO_MASK_PATTERN=21522;var dt=function(t){Object(w.a)(n,t);var e=Object(v.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return n}(V),yt=function(){function t(){Object(l.a)(this,t)}return Object(c.a)(t,null,[{key:"decode",value:function(t,e){var n=this.encodingName(e);return"undefined"===typeof TextDecoder?this.decodeFallback(t,n):new TextDecoder(n).decode(t)}},{key:"encode",value:function(e,n){return t.isBrowser()?"undefined"===typeof TextEncoder?this.encodeFallback(e):(new TextEncoder).encode(e):new TextEncoder(this.encodingName(n),{NONSTANDARD_allowLegacyEncoding:!0}).encode(e)}},{key:"isBrowser",value:function(){return"undefined"!==typeof window&&"[object Window]"==={}.toString.call(window)}},{key:"encodingName",value:function(t){return"string"===typeof t?t:t.getName()}},{key:"encodingCharacterSet",value:function(t){return K.getCharacterSetECIByName(this.encodingName(t))}},{key:"decodeFallback",value:function(t,e){var n=this.encodingCharacterSet(e);if(n.equals(K.UTF8)||n.equals(K.ISO8859_1)||n.equals(K.ASCII)){for(var r="",i=0,a=t.length;i<a;i++){var o=t[i].toString(16);o.length<2&&(o="0"+o),r+="%"+o}return decodeURIComponent(r)}if(n.equals(K.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(t.buffer));throw new dt("Encoding ".concat(this.encodingName(e)," not supported by fallback."))}},{key:"encodeFallback",value:function(t){for(var e=btoa(unescape(encodeURIComponent(t))).split(""),n=[],r=0;r<e.length;r++)n.push(e[r].charCodeAt(0));return new Uint8Array(n)}}]),t}(),gt=function(){function t(e,n){Object(l.a)(this,t),this.dataBytes=e,this.errorCorrectionBytes=n}return Object(c.a)(t,[{key:"getDataBytes",value:function(){return this.dataBytes}},{key:"getErrorCorrectionBytes",value:function(){return this.errorCorrectionBytes}}]),t}(),pt=function(){function t(){Object(l.a)(this,t)}return Object(c.a)(t,null,[{key:"calculateMaskPenalty",value:function(t){return lt.applyMaskPenaltyRule1(t)+lt.applyMaskPenaltyRule2(t)+lt.applyMaskPenaltyRule3(t)+lt.applyMaskPenaltyRule4(t)}},{key:"encode",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=t.DEFAULT_BYTE_MODE_ENCODING,a=null!==r&&void 0!==r.get(L.CHARACTER_SET);a&&(i=r.get(L.CHARACTER_SET).toString());var o=this.chooseMode(e,i),s=new W;if(o===tt.BYTE&&(a||t.DEFAULT_BYTE_MODE_ENCODING!==i)){var h=K.getCharacterSetECIByName(i);void 0!==h&&this.appendECI(h,s)}if(null!==r&&r.has(L.STRUCTURED_APPEND)){var u=r.get(L.STRUCTURED_APPEND);s.appendBits(3,4),s.appendBits(u[0],4),s.appendBits(u[1],4),s.appendBits(u[2],8)}this.appendModeInfo(o,s);var l,c=new W;if(this.appendBytes(e,o,c,i),null!==r&&void 0!==r.get(L.QR_VERSION)){var f=Number.parseInt(r.get(L.QR_VERSION).toString(),10);l=ut.getVersionForNumber(f);var v=this.calculateBitsNeeded(o,s,c,l);if(!this.willFit(v,l,n))throw new vt("Data too big for requested version")}else l=this.recommendVersion(n,o,s,c);var w=new W;w.appendBitArray(s);var d=o===tt.BYTE?c.getSizeInBytes():e.length;this.appendLengthInfo(d,l,o,w),w.appendBitArray(c);var y=l.getECBlocksForLevel(n),g=l.getTotalCodewords()-y.getTotalECCodewords();this.terminateBits(g,w);var p=this.interleaveWithECBytes(w,l.getTotalCodewords(),g,y.getNumBlocks()),m=new ft;m.setECLevel(n),m.setMode(o),m.setVersion(l);var I=l.getDimensionForVersion(),A=new ct(I,I),S=this.chooseMaskPattern(p,n,l,A);return m.setMaskPattern(S),wt.buildMatrix(p,n,l,S,A),m.setMatrix(A),m}},{key:"recommendVersion",value:function(t,e,n,r){var i=this.calculateBitsNeeded(e,n,r,ut.getVersionForNumber(1)),a=this.chooseVersion(i,t),o=this.calculateBitsNeeded(e,n,r,a);return this.chooseVersion(o,t)}},{key:"calculateBitsNeeded",value:function(t,e,n,r){return e.getSize()+t.getCharacterCountBits(r)+n.getSize()}},{key:"getAlphanumericCode",value:function(e){return e<t.ALPHANUMERIC_TABLE.length?t.ALPHANUMERIC_TABLE[e]:-1}},{key:"chooseMode",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e instanceof Uint8Array)return tt.BYTE;if(K.SJIS.getName()===n&&this.isOnlyDoubleByteKanji(e))return tt.KANJI;for(var r=!1,i=!1,a=0,o=e.length;a<o;++a){var s=e.charAt(a);if(t.isDigit(s))r=!0;else{if(-1===this.getAlphanumericCode(s.charCodeAt(0)))return tt.BYTE;i=!0}}return i?tt.ALPHANUMERIC:r?tt.NUMERIC:tt.BYTE}},{key:"isOnlyDoubleByteKanji",value:function(t){var e;try{e=yt.encode(t,K.SJIS)}catch(a){return!1}var n=e.length;if(n%2!==0)return!1;for(var r=0;r<n;r+=2){var i=255&e[r];if((i<129||i>159)&&(i<224||i>235))return!1}return!0}},{key:"chooseMaskPattern",value:function(t,e,n,r){for(var i=Number.MAX_SAFE_INTEGER,a=-1,o=0;o<ft.NUM_MASK_PATTERNS;o++){wt.buildMatrix(t,e,n,o,r);var s=this.calculateMaskPenalty(r);s<i&&(i=s,a=o)}return a}},{key:"chooseVersion",value:function(e,n){for(var r=1;r<=40;r++){var i=ut.getVersionForNumber(r);if(t.willFit(e,i,n))return i}throw new vt("Data too big")}},{key:"willFit",value:function(t,e,n){return e.getTotalCodewords()-e.getECBlocksForLevel(n).getTotalECCodewords()>=(t+7)/8}},{key:"terminateBits",value:function(t,e){var n=8*t;if(e.getSize()>n)throw new vt("data bits cannot fit in the QR Code"+e.getSize()+" > "+n);for(var r=0;r<4&&e.getSize()<n;++r)e.appendBit(!1);var i=7&e.getSize();if(i>0)for(var a=i;a<8;a++)e.appendBit(!1);for(var o=t-e.getSizeInBytes(),s=0;s<o;++s)e.appendBits(0===(1&s)?236:17,8);if(e.getSize()!==n)throw new vt("Bits size does not equal capacity")}},{key:"getNumDataBytesAndNumECBytesForBlockID",value:function(t,e,n,r,i,a){if(r>=n)throw new vt("Block ID too large");var o=t%n,s=n-o,h=Math.floor(t/n),u=h+1,l=Math.floor(e/n),c=l+1,f=h-l,v=u-c;if(f!==v)throw new vt("EC bytes mismatch");if(n!==s+o)throw new vt("RS blocks mismatch");if(t!==(l+f)*s+(c+v)*o)throw new vt("Total bytes mismatch");r<s?(i[0]=l,a[0]=f):(i[0]=c,a[0]=v)}},{key:"interleaveWithECBytes",value:function(e,n,r,i){if(e.getSizeInBytes()!==r)throw new vt("Number of bits and data bytes does not match");for(var a=0,o=0,s=0,h=[],u=0;u<i;++u){var l=new Int32Array(1),c=new Int32Array(1);t.getNumDataBytesAndNumECBytesForBlockID(n,r,i,u,l,c);var f=l[0],v=new Uint8Array(f);e.toBytes(8*a,v,0,f);var w=t.generateECBytes(v,c[0]);h.push(new gt(v,w)),o=Math.max(o,f),s=Math.max(s,w.length),a+=l[0]}if(r!==a)throw new vt("Data bytes does not match offset");for(var d=new W,y=0;y<o;++y){var g,p=Object(k.a)(h);try{for(p.s();!(g=p.n()).done;){var m=g.value.getDataBytes();y<m.length&&d.appendBits(m[y],8)}}catch(C){p.e(C)}finally{p.f()}}for(var I=0;I<s;++I){var A,S=Object(k.a)(h);try{for(S.s();!(A=S.n()).done;){var E=A.value.getErrorCorrectionBytes();I<E.length&&d.appendBits(E[I],8)}}catch(C){S.e(C)}finally{S.f()}}if(n!==d.getSizeInBytes())throw new vt("Interleaving error: "+n+" and "+d.getSizeInBytes()+" differ.");return d}},{key:"generateECBytes",value:function(t,e){for(var n=t.length,r=new Int32Array(n+e),i=0;i<n;i++)r[i]=255&t[i];new $(q.QR_CODE_FIELD_256).encode(r,e);for(var a=new Uint8Array(e),o=0;o<e;o++)a[o]=r[n+o];return a}},{key:"appendModeInfo",value:function(t,e){e.appendBits(t.getBits(),4)}},{key:"appendLengthInfo",value:function(t,e,n,r){var i=n.getCharacterCountBits(e);if(t>=1<<i)throw new vt(t+" is bigger than "+((1<<i)-1));r.appendBits(t,i)}},{key:"appendBytes",value:function(e,n,r,i){if(e instanceof Uint8Array)return t.append8BitBytes(e,r,i);switch(n){case tt.NUMERIC:t.appendNumericBytes(e,r);break;case tt.ALPHANUMERIC:t.appendAlphanumericBytes(e,r);break;case tt.BYTE:t.append8BitBytes(e,r,i);break;case tt.KANJI:t.appendKanjiBytes(e,r);break;default:throw new vt("Invalid mode: "+n)}}},{key:"getDigit",value:function(t){return t.charCodeAt(0)-48}},{key:"isDigit",value:function(e){var n=t.getDigit(e);return n>=0&&n<=9}},{key:"appendNumericBytes",value:function(e,n){for(var r=e.length,i=0;i<r;){var a=t.getDigit(e.charAt(i));if(i+2<r){var o=t.getDigit(e.charAt(i+1)),s=t.getDigit(e.charAt(i+2));n.appendBits(100*a+10*o+s,10),i+=3}else if(i+1<r){var h=t.getDigit(e.charAt(i+1));n.appendBits(10*a+h,7),i+=2}else n.appendBits(a,4),i++}}},{key:"appendAlphanumericBytes",value:function(e,n){for(var r=e.length,i=0;i<r;){var a=t.getAlphanumericCode(e.charCodeAt(i));if(-1===a)throw new vt;if(i+1<r){var o=t.getAlphanumericCode(e.charCodeAt(i+1));if(-1===o)throw new vt;n.appendBits(45*a+o,11),i+=2}else n.appendBits(a,6),i++}}},{key:"append8BitBytes",value:function(t,e,n){if(t instanceof Uint8Array)for(var r=0,i=t.length;r!==i;r++){var a=t[r];e.appendBits(a,8)}else{var o;try{o=yt.encode(t,n)}catch(l){throw new vt(l)}for(var s=0,h=o.length;s!==h;s++){var u=o[s];e.appendBits(u,8)}}}},{key:"appendKanjiBytes",value:function(t,e){var n;try{n=yt.encode(t,K.SJIS)}catch(h){throw new vt(h)}for(var r=n.length,i=0;i<r;i+=2){var a=(255&n[i])<<8&4294967295|255&n[i+1],o=-1;if(a>=33088&&a<=40956?o=a-33088:a>=57408&&a<=60351&&(o=a-49472),-1===o)throw new vt("Invalid byte sequence");var s=192*(o>>8)+(255&o);e.appendBits(s,13)}}},{key:"appendECI",value:function(t,e){e.appendBits(tt.ECI.getBits(),4),e.appendBits(t.getValue(),8)}}]),t}();pt.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),pt.DEFAULT_BYTE_MODE_ENCODING=K.UTF8.getName();var mt=function(t){Object(w.a)(n,t);var e=Object(v.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return n}(V),It=function(){function t(){Object(l.a)(this,t)}return Object(c.a)(t,[{key:"write",value:function(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(0===e.length)throw new G("Found empty contents");if(n<0||r<0)throw new G("Requested dimensions are too small: "+n+"x"+r);var a=at.L,o=t.QUIET_ZONE_SIZE;null!==i&&(void 0!==i.get(L.ERROR_CORRECTION)&&(a=at.fromString(i.get(L.ERROR_CORRECTION).toString())),void 0!==i.get(L.MARGIN)&&(o=Number.parseInt(i.get(L.MARGIN).toString(),10)));var s=pt.encode(e,a,i);return this.renderResult(s,n,r,o)}},{key:"writeToDom",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;"string"===typeof t&&(t=document.querySelector(t));var a=this.write(e,n,r,i);t&&t.appendChild(a)}},{key:"renderResult",value:function(t,e,n,r){var i=t.getMatrix();if(null===i)throw new mt;for(var a=i.getWidth(),o=i.getHeight(),s=a+2*r,h=o+2*r,u=Math.max(e,s),l=Math.max(n,h),c=Math.min(Math.floor(u/s),Math.floor(l/h)),f=Math.floor((u-a*c)/2),v=Math.floor((l-o*c)/2),w=this.createSVGElement(u,l),d=0,y=v;d<o;d++,y+=c)for(var g=0,p=f;g<a;g++,p+=c)if(1===i.get(g,d)){var m=this.createSvgRectElement(p,y,c,c);w.appendChild(m)}return w}},{key:"createSVGElement",value:function(e,n){var r=document.createElementNS(t.SVG_NS,"svg");return r.setAttributeNS(null,"height",e.toString()),r.setAttributeNS(null,"width",n.toString()),r}},{key:"createSvgRectElement",value:function(e,n,r,i){var a=document.createElementNS(t.SVG_NS,"rect");return a.setAttributeNS(null,"x",e.toString()),a.setAttributeNS(null,"y",n.toString()),a.setAttributeNS(null,"height",r.toString()),a.setAttributeNS(null,"width",i.toString()),a.setAttributeNS(null,"fill","#000000"),a}}]),t}();It.QUIET_ZONE_SIZE=4,It.SVG_NS="http://www.w3.org/2000/svg";var At=function(){function t(e,n){Object(l.a)(this,t),this.width=e,this.height=n}return Object(c.a)(t,[{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"isCropSupported",value:function(){return!1}},{key:"crop",value:function(t,e,n,r){throw new dt("This luminance source does not support cropping.")}},{key:"isRotateSupported",value:function(){return!1}},{key:"rotateCounterClockwise",value:function(){throw new dt("This luminance source does not support rotation by 90 degrees.")}},{key:"rotateCounterClockwise45",value:function(){throw new dt("This luminance source does not support rotation by 45 degrees.")}},{key:"toString",value:function(){for(var t=new Uint8ClampedArray(this.width),e=new nt,n=0;n<this.height;n++){for(var r=this.getRow(n,t),i=0;i<this.width;i++){var a=255&r[i],o=void 0;o=a<64?"#":a<128?"+":a<192?".":" ",e.append(o)}e.append("\n")}return e.toString()}}]),t}(),St=function(t){Object(w.a)(n,t);var e=Object(v.a)(n);function n(t){var r;return Object(l.a)(this,n),(r=e.call(this,t.getWidth(),t.getHeight())).delegate=t,r}return Object(c.a)(n,[{key:"getRow",value:function(t,e){for(var n=this.delegate.getRow(t,e),r=this.getWidth(),i=0;i<r;i++)n[i]=255-(255&n[i]);return n}},{key:"getMatrix",value:function(){for(var t=this.delegate.getMatrix(),e=this.getWidth()*this.getHeight(),n=new Uint8ClampedArray(e),r=0;r<e;r++)n[r]=255-(255&t[r]);return n}},{key:"isCropSupported",value:function(){return this.delegate.isCropSupported()}},{key:"crop",value:function(t,e,r,i){return new n(this.delegate.crop(t,e,r,i))}},{key:"isRotateSupported",value:function(){return this.delegate.isRotateSupported()}},{key:"invert",value:function(){return this.delegate}},{key:"rotateCounterClockwise",value:function(){return new n(this.delegate.rotateCounterClockwise())}},{key:"rotateCounterClockwise45",value:function(){return new n(this.delegate.rotateCounterClockwise45())}}]),n}(At);(function(t){Object(w.a)(n,t);var e=Object(v.a)(n);function n(t){var r;return Object(l.a)(this,n),(r=e.call(this,t.width,t.height)).canvas=t,r.tempCanvasElement=null,r.buffer=n.makeBufferFromCanvasImageData(t),r}return Object(c.a)(n,[{key:"getRow",value:function(t,e){if(t<0||t>=this.getHeight())throw new G("Requested row is outside the image: "+t);var n=this.getWidth(),r=t*n;return null===e?e=this.buffer.slice(r,r+n):(e.length<n&&(e=new Uint8ClampedArray(n)),e.set(this.buffer.slice(r,r+n))),e}},{key:"getMatrix",value:function(){return this.buffer}},{key:"isCropSupported",value:function(){return!0}},{key:"crop",value:function(t,e,n,r){return this.crop(t,e,n,r),this}},{key:"isRotateSupported",value:function(){return!0}},{key:"rotateCounterClockwise",value:function(){return this.rotate(-90),this}},{key:"rotateCounterClockwise45",value:function(){return this.rotate(-45),this}},{key:"getTempCanvasElement",value:function(){if(null===this.tempCanvasElement){var t=this.canvas.ownerDocument.createElement("canvas");t.width=this.canvas.width,t.height=this.canvas.height,this.tempCanvasElement=t}return this.tempCanvasElement}},{key:"rotate",value:function(t){var e=this.getTempCanvasElement(),r=e.getContext("2d"),i=t*n.DEGREE_TO_RADIANS,a=this.canvas.width,o=this.canvas.height,s=Math.ceil(Math.abs(Math.cos(i))*a+Math.abs(Math.sin(i))*o),h=Math.ceil(Math.abs(Math.sin(i))*a+Math.abs(Math.cos(i))*o);return e.width=s,e.height=h,r.translate(s/2,h/2),r.rotate(i),r.drawImage(this.canvas,a/-2,o/-2),this.buffer=n.makeBufferFromCanvasImageData(e),this}},{key:"invert",value:function(){return new St(this)}}],[{key:"makeBufferFromCanvasImageData",value:function(t){var e=t.getContext("2d").getImageData(0,0,t.width,t.height);return n.toGrayscaleBuffer(e.data,t.width,t.height)}},{key:"toGrayscaleBuffer",value:function(t,e,n){for(var r=new Uint8ClampedArray(e*n),i=0,a=0,o=t.length;i<o;i+=4,a++){var s=void 0;if(0===t[i+3])s=255;else s=306*t[i]+601*t[i+1]+117*t[i+2]+512>>10;r[a]=s}return r}}]),n}(At)).DEGREE_TO_RADIANS=Math.PI/180;var kt,Et=function(t){Object(w.a)(n,t);var e=Object(v.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return n}(V);!function(t){t[t.AZTEC=0]="AZTEC",t[t.CODABAR=1]="CODABAR",t[t.CODE_39=2]="CODE_39",t[t.CODE_93=3]="CODE_93",t[t.CODE_128=4]="CODE_128",t[t.DATA_MATRIX=5]="DATA_MATRIX",t[t.EAN_8=6]="EAN_8",t[t.EAN_13=7]="EAN_13",t[t.ITF=8]="ITF",t[t.MAXICODE=9]="MAXICODE",t[t.PDF_417=10]="PDF_417",t[t.QR_CODE=11]="QR_CODE",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"}(kt||(kt={}));var Ct,Ot=kt,bt=function(){function t(e){Object(l.a)(this,t),this.source=e}return Object(c.a)(t,[{key:"getLuminanceSource",value:function(){return this.source}},{key:"getWidth",value:function(){return this.source.getWidth()}},{key:"getHeight",value:function(){return this.source.getHeight()}}]),t}();!function(t){t[t.OTHER=0]="OTHER",t[t.PURE_BARCODE=1]="PURE_BARCODE",t[t.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",t[t.TRY_HARDER=3]="TRY_HARDER",t[t.CHARACTER_SET=4]="CHARACTER_SET",t[t.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",t[t.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",t[t.ASSUME_GS1=7]="ASSUME_GS1",t[t.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",t[t.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",t[t.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"}(Ct||(Ct={}));var _t=Ct,Tt=function(){function t(){Object(l.a)(this,t)}return Object(c.a)(t,[{key:"encode",value:function(e,n,r,i,a){if(0===e.length)throw new G("Found empty contents");if(n!==Ot.QR_CODE)throw new G("Can only encode QR_CODE, but got "+n);if(r<0||i<0)throw new G("Requested dimensions are too small: ".concat(r,"x").concat(i));var o=at.L,s=t.QUIET_ZONE_SIZE;null!==a&&(void 0!==a.get(L.ERROR_CORRECTION)&&(o=at.fromString(a.get(L.ERROR_CORRECTION).toString())),void 0!==a.get(L.MARGIN)&&(s=Number.parseInt(a.get(L.MARGIN).toString(),10)));var h=pt.encode(e,o,a);return t.renderResult(h,r,i,s)}}],[{key:"renderResult",value:function(t,e,n,r){var i=t.getMatrix();if(null===i)throw new mt;for(var a=i.getWidth(),o=i.getHeight(),s=a+2*r,h=o+2*r,u=Math.max(e,s),l=Math.max(n,h),c=Math.min(Math.floor(u/s),Math.floor(l/h)),f=Math.floor((u-a*c)/2),v=Math.floor((l-o*c)/2),w=new rt(u,l),d=0,y=v;d<o;d++,y+=c)for(var g=0,p=f;g<a;g++,p+=c)1===i.get(g,d)&&w.setRegion(p,y,c,c);return w}}]),t}();Tt.QUIET_ZONE_SIZE=4;(function(t){Object(w.a)(n,t);var e=Object(v.a)(n);function n(t,r,i,a,o,s,h,u){var c;if(Object(l.a)(this,n),(c=e.call(this,s,h)).yuvData=t,c.dataWidth=r,c.dataHeight=i,c.left=a,c.top=o,a+s>r||o+h>i)throw new G("Crop rectangle does not fit within image data.");return u&&c.reverseHorizontal(s,h),c}return Object(c.a)(n,[{key:"getRow",value:function(t,e){if(t<0||t>=this.getHeight())throw new G("Requested row is outside the image: "+t);var n=this.getWidth();(null===e||void 0===e||e.length<n)&&(e=new Uint8ClampedArray(n));var r=(t+this.top)*this.dataWidth+this.left;return x.arraycopy(this.yuvData,r,e,0,n),e}},{key:"getMatrix",value:function(){var t=this.getWidth(),e=this.getHeight();if(t===this.dataWidth&&e===this.dataHeight)return this.yuvData;var n=t*e,r=new Uint8ClampedArray(n),i=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return x.arraycopy(this.yuvData,i,r,0,n),r;for(var a=0;a<e;a++){var o=a*t;x.arraycopy(this.yuvData,i,r,o,t),i+=this.dataWidth}return r}},{key:"isCropSupported",value:function(){return!0}},{key:"crop",value:function(t,e,r,i){return new n(this.yuvData,this.dataWidth,this.dataHeight,this.left+t,this.top+e,r,i,!1)}},{key:"renderThumbnail",value:function(){for(var t=this.getWidth()/n.THUMBNAIL_SCALE_FACTOR,e=this.getHeight()/n.THUMBNAIL_SCALE_FACTOR,r=new Int32Array(t*e),i=this.yuvData,a=this.top*this.dataWidth+this.left,o=0;o<e;o++){for(var s=o*t,h=0;h<t;h++){var u=255&i[a+h*n.THUMBNAIL_SCALE_FACTOR];r[s+h]=4278190080|65793*u}a+=this.dataWidth*n.THUMBNAIL_SCALE_FACTOR}return r}},{key:"getThumbnailWidth",value:function(){return this.getWidth()/n.THUMBNAIL_SCALE_FACTOR}},{key:"getThumbnailHeight",value:function(){return this.getHeight()/n.THUMBNAIL_SCALE_FACTOR}},{key:"reverseHorizontal",value:function(t,e){for(var n=this.yuvData,r=0,i=this.top*this.dataWidth+this.left;r<e;r++,i+=this.dataWidth)for(var a=i+t/2,o=i,s=i+t-1;o<a;o++,s--){var h=n[o];n[o]=n[s],n[s]=h}}},{key:"invert",value:function(){return new St(this)}}]),n}(At)).THUMBNAIL_SCALE_FACTOR=2;var Bt;!function(t){t[t.OTHER=0]="OTHER",t[t.ORIENTATION=1]="ORIENTATION",t[t.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",t[t.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",t[t.ISSUE_NUMBER=4]="ISSUE_NUMBER",t[t.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",t[t.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",t[t.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",t[t.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",t[t.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",t[t.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"}(Bt||(Bt={}));var Nt=function(){function t(){Object(l.a)(this,t)}return Object(c.a)(t,null,[{key:"checkAndNudgePoints",value:function(t,e){for(var n=t.getWidth(),r=t.getHeight(),i=!0,a=0;a<e.length&&i;a+=2){var o=Math.floor(e[a]),s=Math.floor(e[a+1]);if(o<-1||o>n||s<-1||s>r)throw new Et;i=!1,-1===o?(e[a]=0,i=!0):o===n&&(e[a]=n-1,i=!0),-1===s?(e[a+1]=0,i=!0):s===r&&(e[a+1]=r-1,i=!0)}i=!0;for(var h=e.length-2;h>=0&&i;h-=2){var u=Math.floor(e[h]),l=Math.floor(e[h+1]);if(u<-1||u>n||l<-1||l>r)throw new Et;i=!1,-1===u?(e[h]=0,i=!0):u===n&&(e[h]=n-1,i=!0),-1===l?(e[h+1]=0,i=!0):l===r&&(e[h+1]=r-1,i=!0)}}}]),t}(),Rt=function(){function t(e,n,r,i,a,o,s,h,u){Object(l.a)(this,t),this.a11=e,this.a21=n,this.a31=r,this.a12=i,this.a22=a,this.a32=o,this.a13=s,this.a23=h,this.a33=u}return Object(c.a)(t,[{key:"transformPoints",value:function(t){for(var e=t.length,n=this.a11,r=this.a12,i=this.a13,a=this.a21,o=this.a22,s=this.a23,h=this.a31,u=this.a32,l=this.a33,c=0;c<e;c+=2){var f=t[c],v=t[c+1],w=i*f+s*v+l;t[c]=(n*f+a*v+h)/w,t[c+1]=(r*f+o*v+u)/w}}},{key:"transformPointsWithValues",value:function(t,e){for(var n=this.a11,r=this.a12,i=this.a13,a=this.a21,o=this.a22,s=this.a23,h=this.a31,u=this.a32,l=this.a33,c=t.length,f=0;f<c;f++){var v=t[f],w=e[f],d=i*v+s*w+l;t[f]=(n*v+a*w+h)/d,e[f]=(r*v+o*w+u)/d}}},{key:"buildAdjoint",value:function(){return new t(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}},{key:"times",value:function(e){return new t(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}],[{key:"quadrilateralToQuadrilateral",value:function(e,n,r,i,a,o,s,h,u,l,c,f,v,w,d,y){var g=t.quadrilateralToSquare(e,n,r,i,a,o,s,h);return t.squareToQuadrilateral(u,l,c,f,v,w,d,y).times(g)}},{key:"squareToQuadrilateral",value:function(e,n,r,i,a,o,s,h){var u=e-r+a-s,l=n-i+o-h;if(0===u&&0===l)return new t(r-e,a-r,e,i-n,o-i,n,0,0,1);var c=r-a,f=s-a,v=i-o,w=h-o,d=c*w-f*v,y=(u*w-f*l)/d,g=(c*l-u*v)/d;return new t(r-e+y*r,s-e+g*s,e,i-n+y*i,h-n+g*h,n,y,g,1)}},{key:"quadrilateralToSquare",value:function(e,n,r,i,a,o,s,h){return t.squareToQuadrilateral(e,n,r,i,a,o,s,h).buildAdjoint()}}]),t}(),Mt=function(t){Object(w.a)(n,t);var e=Object(v.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(c.a)(n,[{key:"sampleGrid",value:function(t,e,n,r,i,a,o,s,h,u,l,c,f,v,w,d,y,g,p){var m=Rt.quadrilateralToQuadrilateral(r,i,a,o,s,h,u,l,c,f,v,w,d,y,g,p);return this.sampleGridWithTransform(t,e,n,m)}},{key:"sampleGridWithTransform",value:function(t,e,n,r){if(e<=0||n<=0)throw new Et;for(var i=new rt(e,n),a=new Float32Array(2*e),o=0;o<n;o++){for(var s=a.length,h=o+.5,u=0;u<s;u+=2)a[u]=u/2+.5,a[u+1]=h;r.transformPoints(a),Nt.checkAndNudgePoints(t,a);try{for(var l=0;l<s;l+=2)t.get(Math.floor(a[l]),Math.floor(a[l+1]))&&i.set(l/2,o)}catch(c){throw new Et}}return i}}]),n}(Nt),Ft=function(t){Object(w.a)(n,t);var e=Object(v.a)(n);function n(t){var r;return Object(l.a)(this,n),(r=e.call(this,t)).luminances=n.EMPTY,r.buckets=new Int32Array(n.LUMINANCE_BUCKETS),r}return Object(c.a)(n,[{key:"getBlackRow",value:function(t,e){var r=this.getLuminanceSource(),i=r.getWidth();void 0===e||null===e||e.getSize()<i?e=new W(i):e.clear(),this.initArrays(i);for(var a=r.getRow(t,this.luminances),o=this.buckets,s=0;s<i;s++)o[(255&a[s])>>n.LUMINANCE_SHIFT]++;var h=n.estimateBlackPoint(o);if(i<3)for(var u=0;u<i;u++)(255&a[u])<h&&e.set(u);else for(var l=255&a[0],c=255&a[1],f=1;f<i-1;f++){var v=255&a[f+1];(4*c-l-v)/2<h&&e.set(f),l=c,c=v}return e}},{key:"getBlackMatrix",value:function(){var t=this.getLuminanceSource(),e=t.getWidth(),r=t.getHeight(),i=new rt(e,r);this.initArrays(e);for(var a=this.buckets,o=1;o<5;o++)for(var s=r*o/5,h=t.getRow(s,this.luminances),u=Math.floor(4*e/5),l=Math.floor(e/5);l<u;l++){a[(255&h[l])>>n.LUMINANCE_SHIFT]++}for(var c=n.estimateBlackPoint(a),f=t.getMatrix(),v=0;v<r;v++)for(var w=v*e,d=0;d<e;d++){(255&f[w+d])<c&&i.set(d,v)}return i}},{key:"createBinarizer",value:function(t){return new n(t)}},{key:"initArrays",value:function(t){this.luminances.length<t&&(this.luminances=new Uint8ClampedArray(t));for(var e=this.buckets,r=0;r<n.LUMINANCE_BUCKETS;r++)e[r]=0}}],[{key:"estimateBlackPoint",value:function(t){for(var e=t.length,r=0,i=0,a=0,o=0;o<e;o++)t[o]>a&&(i=o,a=t[o]),t[o]>r&&(r=t[o]);for(var s=0,h=0,u=0;u<e;u++){var l=u-i,c=t[u]*l*l;c>h&&(s=u,h=c)}if(i>s){var f=i;i=s,s=f}if(s-i<=e/16)throw new Et;for(var v=s-1,w=-1,d=s-1;d>i;d--){var y=d-i,g=y*y*(s-d)*(r-t[d]);g>w&&(v=d,w=g)}return v<<n.LUMINANCE_SHIFT}}]),n}(bt);Ft.LUMINANCE_BITS=5,Ft.LUMINANCE_SHIFT=8-Ft.LUMINANCE_BITS,Ft.LUMINANCE_BUCKETS=1<<Ft.LUMINANCE_BITS,Ft.EMPTY=Uint8ClampedArray.from([0]),(function(){function t(){Object(l.a)(this,t)}return Object(c.a)(t,null,[{key:"setGridSampler",value:function(e){t.gridSampler=e}},{key:"getInstance",value:function(){return t.gridSampler}}]),t}()).gridSampler=new Mt;var Dt=n(56),Pt=n(132),Ut=function(t){Object(w.a)(n,t);var e=Object(v.a)(n);function n(t){var r;return Object(l.a)(this,n),(r=e.call(this,t)).matrix=null,r}return Object(c.a)(n,[{key:"getBlackMatrix",value:function(){if(null!==this.matrix)return this.matrix;var t=this.getLuminanceSource(),e=t.getWidth(),r=t.getHeight();if(e>=n.MINIMUM_DIMENSION&&r>=n.MINIMUM_DIMENSION){var i=t.getMatrix(),a=e>>n.BLOCK_SIZE_POWER;0!==(e&n.BLOCK_SIZE_MASK)&&a++;var o=r>>n.BLOCK_SIZE_POWER;0!==(r&n.BLOCK_SIZE_MASK)&&o++;var s=n.calculateBlackPoints(i,a,o,e,r),h=new rt(e,r);n.calculateThresholdForBlock(i,a,o,e,r,s,h),this.matrix=h}else this.matrix=Object(Pt.a)(Object(Dt.a)(n.prototype),"getBlackMatrix",this).call(this);return this.matrix}},{key:"createBinarizer",value:function(t){return new n(t)}}],[{key:"calculateThresholdForBlock",value:function(t,e,r,i,a,o,s){for(var h=a-n.BLOCK_SIZE,u=i-n.BLOCK_SIZE,l=0;l<r;l++){var c=l<<n.BLOCK_SIZE_POWER;c>h&&(c=h);for(var f=n.cap(l,2,r-3),v=0;v<e;v++){var w=v<<n.BLOCK_SIZE_POWER;w>u&&(w=u);for(var d=n.cap(v,2,e-3),y=0,g=-2;g<=2;g++){var p=o[f+g];y+=p[d-2]+p[d-1]+p[d]+p[d+1]+p[d+2]}var m=y/25;n.thresholdBlock(t,w,c,m,i,s)}}}},{key:"cap",value:function(t,e,n){return t<e?e:t>n?n:t}},{key:"thresholdBlock",value:function(t,e,r,i,a,o){for(var s=0,h=r*a+e;s<n.BLOCK_SIZE;s++,h+=a)for(var u=0;u<n.BLOCK_SIZE;u++)(255&t[h+u])<=i&&o.set(e+u,r+s)}},{key:"calculateBlackPoints",value:function(t,e,r,i,a){for(var o=a-n.BLOCK_SIZE,s=i-n.BLOCK_SIZE,h=new Array(r),u=0;u<r;u++){h[u]=new Int32Array(e);var l=u<<n.BLOCK_SIZE_POWER;l>o&&(l=o);for(var c=0;c<e;c++){var f=c<<n.BLOCK_SIZE_POWER;f>s&&(f=s);for(var v=0,w=255,d=0,y=0,g=l*i+f;y<n.BLOCK_SIZE;y++,g+=i){for(var p=0;p<n.BLOCK_SIZE;p++){var m=255&t[g+p];v+=m,m<w&&(w=m),m>d&&(d=m)}if(d-w>n.MIN_DYNAMIC_RANGE)for(y++,g+=i;y<n.BLOCK_SIZE;y++,g+=i)for(var I=0;I<n.BLOCK_SIZE;I++)v+=255&t[g+I]}var A=v>>2*n.BLOCK_SIZE_POWER;if(d-w<=n.MIN_DYNAMIC_RANGE&&(A=w/2,u>0&&c>0)){var S=(h[u-1][c]+2*h[u][c-1]+h[u-1][c-1])/4;w<S&&(A=S)}h[u][c]=A}}return h}}]),n}(Ft);Ut.BLOCK_SIZE_POWER=3,Ut.BLOCK_SIZE=1<<Ut.BLOCK_SIZE_POWER,Ut.BLOCK_SIZE_MASK=Ut.BLOCK_SIZE-1,Ut.MINIMUM_DIMENSION=5*Ut.BLOCK_SIZE,Ut.MIN_DYNAMIC_RANGE=24;var Lt=function(){function t(){Object(l.a)(this,t)}return Object(c.a)(t,null,[{key:"guessEncoding",value:function(e,n){if(null!==n&&void 0!==n&&void 0!==n.get(_t.CHARACTER_SET))return n.get(_t.CHARACTER_SET).toString();for(var r=e.length,i=!0,a=!0,o=!0,s=0,h=0,u=0,l=0,c=0,f=0,v=0,w=0,d=0,y=0,g=0,p=e.length>3&&239===e[0]&&187===e[1]&&191===e[2],m=0;m<r&&(i||a||o);m++){var I=255&e[m];o&&(s>0?0===(128&I)?o=!1:s--:0!==(128&I)&&(0===(64&I)?o=!1:(s++,0===(32&I)?h++:(s++,0===(16&I)?u++:(s++,0===(8&I)?l++:o=!1))))),i&&(I>127&&I<160?i=!1:I>159&&(I<192||215===I||247===I)&&g++),a&&(c>0?I<64||127===I||I>252?a=!1:c--:128===I||160===I||I>239?a=!1:I>160&&I<224?(f++,w=0,++v>d&&(d=v)):I>127?(c++,v=0,++w>y&&(y=w)):(v=0,w=0))}return o&&s>0&&(o=!1),a&&c>0&&(a=!1),o&&(p||h+u+l>0)?t.UTF8:a&&(t.ASSUME_SHIFT_JIS||d>=3||y>=3)?t.SHIFT_JIS:i&&a?2===d&&2===f||10*g>=r?t.SHIFT_JIS:t.ISO88591:i?t.ISO88591:a?t.SHIFT_JIS:o?t.UTF8:t.PLATFORM_DEFAULT_ENCODING}},{key:"format",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=-1;function a(t,e,r,a,o,s){if("%%"===t)return"%";if(void 0!==n[++i]){t=a?parseInt(a.substr(1)):void 0;var h,u=o?parseInt(o.substr(1)):void 0;switch(s){case"s":h=n[i];break;case"c":h=n[i][0];break;case"f":h=parseFloat(n[i]).toFixed(t);break;case"p":h=parseFloat(n[i]).toPrecision(t);break;case"e":h=parseFloat(n[i]).toExponential(t);break;case"x":h=parseInt(n[i]).toString(u||16);break;case"d":h=parseFloat(parseInt(n[i],u||10).toPrecision(t)).toFixed(0)}h="object"===typeof h?JSON.stringify(h):(+h).toString(u);for(var l=parseInt(r),c=r&&r[0]+""==="0"?"0":" ";h.length<l;)h=void 0!==e?h+c:c+h;return h}}var o=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return t.replace(o,a)}},{key:"getBytes",value:function(t,e){return yt.encode(t,e)}},{key:"getCharCode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.charCodeAt(e)}}]),t}();Lt.SHIFT_JIS=K.SJIS.getName(),Lt.GB2312="GB2312",Lt.ISO88591=K.ISO8859_1.getName(),Lt.EUC_JP="EUC_JP",Lt.UTF8=K.UTF8.getName(),Lt.PLATFORM_DEFAULT_ENCODING=Lt.UTF8,Lt.ASSUME_SHIFT_JIS=!1;var xt=function(){function t(){Object(l.a)(this,t)}return Object(c.a)(t,[{key:"MathUtils",value:function(){}}],[{key:"round",value:function(t){return isNaN(t)?0:t<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:t>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:t+(t<0?-.5:.5)|0}},{key:"distance",value:function(t,e,n,r){var i=t-n,a=e-r;return Math.sqrt(i*i+a*a)}},{key:"sum",value:function(t){for(var e=0,n=0,r=t.length;n!==r;n++){e+=t[n]}return e}}]),t}(),jt=function(){function t(){Object(l.a)(this,t)}return Object(c.a)(t,null,[{key:"floatToIntBits",value:function(t){return t}}]),t}(),zt=function(){function t(e,n){Object(l.a)(this,t),this.x=e,this.y=n}return Object(c.a)(t,[{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"equals",value:function(e){if(e instanceof t){var n=e;return this.x===n.x&&this.y===n.y}return!1}},{key:"hashCode",value:function(){return 31*jt.floatToIntBits(this.x)+jt.floatToIntBits(this.y)}},{key:"toString",value:function(){return"("+this.x+","+this.y+")"}}],[{key:"orderBestPatterns",value:function(t){var e,n,r,i=this.distance(t[0],t[1]),a=this.distance(t[1],t[2]),o=this.distance(t[0],t[2]);if(a>=i&&a>=o?(n=t[0],e=t[1],r=t[2]):o>=a&&o>=i?(n=t[1],e=t[0],r=t[2]):(n=t[2],e=t[0],r=t[1]),this.crossProductZ(e,n,r)<0){var s=e;e=r,r=s}t[0]=e,t[1]=n,t[2]=r}},{key:"orderBestMultiplePatterns",value:function(t){var e=this;t.forEach((function(t){var n,r,i,a=e.distance(t[0],t[1]),o=e.distance(t[1],t[2]),s=e.distance(t[0],t[2]);if(o>=a&&o>=s?(r=t[0],n=t[1],i=t[2]):s>=o&&s>=a?(r=t[1],n=t[0],i=t[2]):(r=t[2],n=t[0],i=t[1]),e.crossProductZ(n,r,i)<0){var h=n;n=i,i=h}t[0]=n,t[1]=r,t[2]=i}))}},{key:"distance",value:function(t,e){return xt.distance(t.x,t.y,e.x,e.y)}},{key:"crossProductZ",value:function(t,e,n){var r=e.x,i=e.y;return(n.x-r)*(t.y-i)-(n.y-i)*(t.x-r)}}]),t}(),Ht=function(){function t(e,n,r,i){Object(l.a)(this,t),this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),void 0!==n&&null!==n||(n=t.INIT_SIZE),void 0!==r&&null!==r||(r=e.getWidth()/2|0),void 0!==i&&null!==i||(i=e.getHeight()/2|0);var a=n/2|0;if(this.leftInit=r-a,this.rightInit=r+a,this.upInit=i-a,this.downInit=i+a,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new Et}return Object(c.a)(t,[{key:"detect",value:function(){for(var t=this.leftInit,e=this.rightInit,n=this.upInit,r=this.downInit,i=!1,a=!0,o=!1,s=!1,h=!1,u=!1,l=!1,c=this.width,f=this.height;a;){a=!1;for(var v=!0;(v||!s)&&e<c;)(v=this.containsBlackPoint(n,r,e,!1))?(e++,a=!0,s=!0):s||e++;if(e>=c){i=!0;break}for(var w=!0;(w||!h)&&r<f;)(w=this.containsBlackPoint(t,e,r,!0))?(r++,a=!0,h=!0):h||r++;if(r>=f){i=!0;break}for(var d=!0;(d||!u)&&t>=0;)(d=this.containsBlackPoint(n,r,t,!1))?(t--,a=!0,u=!0):u||t--;if(t<0){i=!0;break}for(var y=!0;(y||!l)&&n>=0;)(y=this.containsBlackPoint(t,e,n,!0))?(n--,a=!0,l=!0):l||n--;if(n<0){i=!0;break}a&&(o=!0)}if(!i&&o){for(var g=e-t,p=null,m=1;null===p&&m<g;m++)p=this.getBlackPointOnSegment(t,r-m,t+m,r);if(null==p)throw new Et;for(var I=null,A=1;null===I&&A<g;A++)I=this.getBlackPointOnSegment(t,n+A,t+A,n);if(null==I)throw new Et;for(var S=null,k=1;null===S&&k<g;k++)S=this.getBlackPointOnSegment(e,n+k,e-k,n);if(null==S)throw new Et;for(var E=null,C=1;null===E&&C<g;C++)E=this.getBlackPointOnSegment(e,r-C,e-C,r);if(null==E)throw new Et;return this.centerEdges(E,p,S,I)}throw new Et}},{key:"getBlackPointOnSegment",value:function(t,e,n,r){for(var i=xt.round(xt.distance(t,e,n,r)),a=(n-t)/i,o=(r-e)/i,s=this.image,h=0;h<i;h++){var u=xt.round(t+h*a),l=xt.round(e+h*o);if(s.get(u,l))return new zt(u,l)}return null}},{key:"centerEdges",value:function(e,n,r,i){var a=e.getX(),o=e.getY(),s=n.getX(),h=n.getY(),u=r.getX(),l=r.getY(),c=i.getX(),f=i.getY(),v=t.CORR;return a<this.width/2?[new zt(c-v,f+v),new zt(s+v,h+v),new zt(u-v,l-v),new zt(a+v,o-v)]:[new zt(c+v,f+v),new zt(s+v,h-v),new zt(u-v,l+v),new zt(a-v,o-v)]}},{key:"containsBlackPoint",value:function(t,e,n,r){var i=this.image;if(r){for(var a=t;a<=e;a++)if(i.get(a,n))return!0}else for(var o=t;o<=e;o++)if(i.get(n,o))return!0;return!1}}]),t}();Ht.INIT_SIZE=10,Ht.CORR=1;function Vt(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,n}var Gt=function(t){var e=t instanceof U?t:new U(t);e.fixIssues();var n=e.typeInfo,r=e.toBytes(),i=Vt(n.size,n.size);i.width=n.size,i.height=n.size,e.addCanvas(i);var a=440,o=270;e.render(),e.width>32&&(a=760,o=460);var s=Vt(a,o),h=s.getContext("2d");h.imageSmoothingEnabled=!1;var u=[];if(n.size>32){var l=new Map,c=Math.round(255*Math.random());l.set(L.STRUCTURED_APPEND,[0,3,c]),u.push(pt.encode(new Uint8Array(r,0,540),at.M,l)),l.set(L.STRUCTURED_APPEND,[1,3,c]),u.push(pt.encode(new Uint8Array(r,540,540),at.M,l)),l.set(L.STRUCTURED_APPEND,[2,3,c]),u.push(pt.encode(new Uint8Array(r,1080,540),at.M,l)),l.set(L.STRUCTURED_APPEND,[3,3,c]),u.push(pt.encode(new Uint8Array(r,1620,540),at.M,l))}else u.push(pt.encode(new Uint8Array(r,0,620),at.M,null));var f=0;u.forEach((function(t){2*t.getMatrix().getWidth()>f&&(f=2*t.getMatrix().getWidth())}));var v,w=n.size,d=n.size;n.sections instanceof Array&&(w=n.sections[2],d=n.sections[3]);var y=2*(f+32)-6;r.byteLength<=620&&(y=a/2);var g=(a-y)/2,p=document.createElement("canvas");p.width=45,p.height=45;var m=p.getContext("2d");m.fillStyle="#FFFFFF",m.fillRect(0,0,45,45),m.fillStyle="#9b003a44",m.rotate(Math.PI/4),m.fillRect(0,-80,16,160),m.fillRect(32,-80,16,160),m.rotate(-Math.PI/2),m.fillRect(0,-80,16,160),m.fillRect(-32,-80,16,160),h.fillStyle=h.createPattern(p,"repeat"),h.fillRect(0,0,a,o);var I=Math.floor((o-60)/d);v=I*d,h.drawImage(i,0,0,w,d,g-w*I/2,(o-v)/2,I*w,v),p.width=1,p.height=2,m.fillStyle="#792e58",m.fillRect(0,0,1,1),m.fillStyle="#883e5f",m.fillRect(0,1,1,1);var A=h.createPattern(p,"repeat"),S=function(t,e,n,r){var i=h.measureText(n),a=i.fontBoundingBoxAscent+i.fontBoundingBoxDescent+4,o=i.width-a/2;h.fillStyle=A,h.strokeStyle=r,h.beginPath(),h.arc(t-o/2,e,a/2,.5*Math.PI,1.5*Math.PI),h.lineTo(t+o/2,e-a/2),h.arc(t+o/2,e,a/2,1.5*Math.PI,.5*Math.PI),h.lineTo(t+-o/2,e+a/2),h.fill(),h.stroke(),h.fillStyle="#00000088",h.strokeStyle="#00000088",h.fillText(n,t+2,e+2),h.fillStyle=r,h.strokeStyle=r,h.fillText(n,t,e)};h.textBaseline="middle",h.textAlign="center",r.byteLength>620?(h.font="15pt Calibri",S(g,(o-v)/4+4,e.title,"#FFFFFF"),h.font="10pt Calibri",S(g,o-(o-v)/4,"By "+e.creator[0]+" from "+e.town[0],"#FFFFFF")):(h.font="15pt Calibri",S(a/2,(o-v)/4-2,e.title,"#FFFFFF"),h.font="10pt Calibri",S(a/2,o-2-(o-v)/4,"By "+e.creator[0]+" from "+e.town[0],"#FFFFFF")),p.width=3,p.height=6,m.fillStyle="#FFFFFF",m.fillRect(0,0,3,6),m.fillStyle="#c7b98c",m.fillRect(.5,0,2,4);var k=h.createPattern(p,"repeat"),E=function(t,e,n){var r=t.getMatrix(),i=r.getWidth();h.fillStyle="#FFFFFF",h.fillRect(e-8,n-8,2*i+16,2*i+16),h.fillStyle=k,h.fillRect(e-3-8,n-8,3,2*i+16),h.fillRect(e+2*i+8,n-8,3,2*i+16),h.fillStyle="#000000";for(var a=0;a<i;a++)for(var o=0;o<i;o++)1===r.get(o,a)&&h.fillRect(e+2*o,n+2*a,2,2)},C=a-(f+32),O=Math.round(o/2);return E(u[0],C-16-f,O-16-f),E(u[1],C+16,O-16-f),E(u[2],C-16-f,O+16),E(u[3],C+16,O+16),h.font="15pt Calibri",S(C-16-f/2,O-16-f-22,"1","#FFFFFF"),S(C+16+f/2,O-16-f-22,"2","#FFFFFF"),S(C-16-f/2,O+16+f+22,"3","#FFFFFF"),S(C+16+f/2,O+16+f+22,"4","#FFFFFF"),s.toDataURL("image/png")},Wt=(n(151),function(t){Object(w.a)(n,t);var e=Object(v.a)(n);function n(t){var r;Object(l.a)(this,n),r=e.call(this,t);var i=t.sketchOptions||{minThickness:.5,thicknessFactor:.1,smoothingFactor:.55,thicknessSmoothingFactor:.6,tipTaperFactor:.7,cappedEnds:!1,borderWidth:2,dotMultiplier:2};return r.canvas=document.createElement("canvas"),r.canvas.width=300,r.canvas.height=300,r.tipCanvas=document.createElement("canvas"),r.tipCanvas.width=r.canvas.width,r.tipCanvas.height=r.canvas.height,r.startX=null,r.startY=null,r.smoothedMouseX=null,r.smoothedMouseY=null,r.lastSmoothedMouse={},r.lastMouse={},r.redraw=r.redraw.bind(Object(f.a)(r)),r.state={sketchOptions:i,generatedQR:null,smallCanvas:null,visible:!1},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.redraw(),this.setState({visible:!0})}},{key:"componentDidUpdate",value:function(t){this.props.lines!==t.lines&&this.redraw()}},{key:"redraw",value:function(){var t=this,e=this.props.shirt;this.drawingTool=new U,this.drawingTool.patternType=4,this.drawingTool.title=e.slogan.slogan.substr(0,20),this.drawingTool.creator=e.designer.name.substr(0,9),this.drawingTool.town="Tee Shirt";var n=this.canvas.getContext("2d"),r=e.drawing.lines;n.clearRect(0,0,this.canvas.width,this.canvas.height),n.save(),n.fillStyle=e.drawing.background,n.fillRect(0,0,this.canvas.width,this.canvas.height),n.restore(),r.forEach((function(e){t.drawLine(e)}));var i=this.createQRCanvas(this.canvas,e.drawing.background);this.imageQuantize(i.getContext("2d").getImageData(0,0,i.width,i.height));var a=Gt(this.drawingTool);this.setState({generatedQR:a,smallCanvas:i})}},{key:"createQRCanvas",value:function(t,e){var n=document.createElement("canvas");n.width=64,n.height=64;var r=n.getContext("2d");return r.save(),r.fillStyle=e,r.fillRect(0,0,64,64),r.restore(),r.drawImage(t,0,0,t.width,t.height,3,1,26,26),n}},{key:"imageQuantize",value:function(t){for(var e=this,n=4*this.drawingTool.pixelCount,r=[],i=0;i<n;i+=4)t.data[i+3]<this.convert_trans||r.push({r:t.data[i],g:t.data[i+1],b:t.data[i+2]});var a=function(t){var e=Math.floor(t.length/2),n=null,r=null,i=null,a=null,o=null,s=null;for(var h in t)(t[h].r<n||null===n)&&(n=t[h].r),(t[h].r>r||null===r)&&(r=t[h].r),(t[h].g<i||null===i)&&(i=t[h].g),(t[h].g>a||null===a)&&(a=t[h].g),(t[h].b<o||null===o)&&(o=t[h].b),(t[h].b>s||null===s)&&(s=t[h].b);var u=r-n,l=a-i,c=s-o;return u>=l&&u>=c?t.sort((function(t,e){return t.r-e.r})):l>=u&&l>=c?t.sort((function(t,e){return t.g-e.g})):t.sort((function(t,e){return t.b-e.b})),[t.slice(0,e),t.slice(e)]},o=function(t){var e=[];for(var n in t){var r=a(t[n]);r[0].length&&e.push(r[0]),r[1].length&&e.push(r[1])}return e},s=a(r);s=o(s),s=o(s),s=o(s);var h=[],u=new Set,l=function(t){var n=0,r=0,i=0;for(var a in t)n+=t[a].r,r+=t[a].g,i+=t[a].b;var o=[Math.round(n/t.length),Math.round(r/t.length),Math.round(i/t.length)],s=e.drawingTool.findRGB(o);u.has(s)||(h.push(s),u.add(s))};for(var c in s)l(s[c]);if(u.size<15){for(var f in s=o(s))l(s[f]);if(u.size<15){for(var v in s=o(s))l(s[v]);if(u.size<15)for(var w in s=o(s))l(s[w])}}else if(u.size>15){var d=195075,y=null,g=null;for(var p in h)for(var m in h)if(!(p>=m)){var I=h[p][0]-h[m][0],A=h[p][1]-h[m][1],S=h[p][2]-h[m][2],E=I*I+A*A+S*S;E<d&&(d=E,y=p,g=m)}var C=s[y].concat(s[g]);h.splice(g),h.splice(y),l(C),u=new Set(h)}var O,b=0,_=Object(k.a)(u);try{for(_.s();!(O=_.n()).done;){var T=O.value;if(b>14)break;this.drawingTool.setPalette(b,T),b++}}catch(M){_.e(M)}finally{_.f()}for(var B=0;B<n;B+=4){var N=(B>>2)%this.drawingTool.width,R=Math.floor((B>>2)/this.drawingTool.width);t.data[B+3]<this.convert_trans?this.drawingTool.setPixel(N,R,15):this.drawingTool.setPixel(N,R,[t.data[B],t.data[B+1],t.data[B+2]])}this.drawingTool.onLoad()}},{key:"startLineInContext",value:function(t,e,n){var r=this.state.sketchOptions,i=this.canvas.getContext("2d"),a=this.tipCanvas.getContext("2d"),o=t*r.minThickness;a.beginPath(),a.arc(e,n,o*r.dotMultiplier,0,2*Math.PI,!0),a.closePath(),a.fill(),a.stroke(),r.cappedEnds&&i.drawImage(a.canvas,0,0),this.lastMouseChangeVector={x:0,y:0},this.startX=this.lastMouse.x=this.smoothedMouseX=this.lastSmoothedMouse.x=e,this.startY=this.lastMouse.y=this.smoothedMouseY=this.lastSmoothedMouse.y=n,this.lastThickness=o,this.lastRotation=void 0,this.colorLevel=0}},{key:"continueLineInContext",value:function(t,e,n){var r=this.state.sketchOptions,i=this.canvas.getContext("2d"),a=this.tipCanvas.getContext("2d"),o=e-this.lastMouse.x,s=n-this.lastMouse.y;o*this.lastMouseChangeVector.x+s*this.lastMouseChangeVector.y<0&&(a&&i.drawImage(a.canvas,0,0),this.smoothedMouseX=this.lastSmoothedMouse.x=this.lastMouse.x,this.smoothedMouseY=this.lastSmoothedMouse.y=this.lastMouse.y,this.lastRotation+=Math.PI,this.lastThickness=r.tipTaperFactor*this.lastThickness),this.smoothedMouseX=this.smoothedMouseX+r.smoothingFactor*(e-this.smoothedMouseX),this.smoothedMouseY=this.smoothedMouseY+r.smoothingFactor*(n-this.smoothedMouseY);var h,u=this.smoothedMouseX-this.lastSmoothedMouse.x,l=this.smoothedMouseY-this.lastSmoothedMouse.y,c=Math.sqrt(u*u+l*l);h=0!==c?Math.PI/2+Math.atan2(l,u):0;var f=r.minThickness*t+r.thicknessFactor*c,v=this.lastThickness+r.thicknessSmoothingFactor*(f-this.lastThickness);void 0===this.lastRotation&&(this.lastRotation=h);var w=null!==this.lastRotation?Math.sin(this.lastRotation):Math.sin(h),d=null!==this.lastRotation?Math.cos(this.lastRotation):Math.sin(h),y=Math.sin(h),g=Math.cos(h),p=this.lastThickness*w,m=this.lastThickness*d,I=v*y,A=v*g,S=.33*c*w,k=-.33*c*d,E=this.lastSmoothedMouse.x+m+S,C=this.lastSmoothedMouse.y+p+k,O=this.lastSmoothedMouse.x-m+S,b=this.lastSmoothedMouse.y-p+k;i.beginPath(),i.moveTo(this.lastSmoothedMouse.x+m,this.lastSmoothedMouse.y+p),i.quadraticCurveTo(E,C,this.smoothedMouseX+A,this.smoothedMouseY+I),i.lineTo(this.smoothedMouseX-A,this.smoothedMouseY-I),i.quadraticCurveTo(O,b,this.lastSmoothedMouse.x-m,this.lastSmoothedMouse.y-p),i.closePath(),i.fill(),i.stroke();var _=r.tipTaperFactor*v;a.clearRect(0,0,a.canvas.width,a.canvas.height),a.beginPath(),a.arc(e,n,_,0,2*Math.PI,!0),a.closePath(),a.fill(),a.stroke(),a.beginPath(),a.moveTo(this.smoothedMouseX+A,this.smoothedMouseY+I),a.lineTo(e+r.tipTaperFactor*A,n+r.tipTaperFactor*I),a.lineTo(e-r.tipTaperFactor*A,n-r.tipTaperFactor*I),a.lineTo(this.smoothedMouseX-A,this.smoothedMouseY-I),a.closePath(),a.fill(),a.stroke(),this.lastSmoothedMouse={x:this.smoothedMouseX,y:this.smoothedMouseY},this.lastRotation=h,this.lastThickness=v,this.lastMouseChangeVector={x:o,y:s},this.lastMouse={x:e,y:n}}},{key:"drawLine",value:function(t){var e=this,n=this.state.sketchOptions,r=this.canvas.getContext("2d"),i=t.points,a=this.tipCanvas,o=this.tipCanvas.getContext("2d"),s=t.thickness;r.strokeStyle=t.color,r.lineWidth=n.borderWidth,r.lineCap="round",r.lineJoin="bevel",r.fillStyle=t.color,r.strokeStyle=t.color,r.globalCompositeOperation=t.highlighter?"destination-over":"source-over",o.lineWidth=n.borderWidth,o.fillStyle=t.color,o.strokeStyle=t.color,(i="string"===typeof i?t.points.split("|").map((function(t){return{x:parseInt(t.split(",")[0]),y:parseInt(t.split(",")[1])}})):i.map((function(t){return{x:parseInt(t.x),y:parseInt(t.y)}}))).forEach((function(t,n){0===n?e.startLineInContext(s,t.x,t.y):e.continueLineInContext(s,t.x,t.y)})),r.drawImage(a,0,0)}},{key:"render",value:function(){var t=this.state,e=t.generatedQR,n=t.visible;return i.a.createElement(E.a,{visible:n,animation:"vertical flip",duration:500},i.a.createElement(S.a,{fluid:!0,className:"TeeKOQRCode"},i.a.createElement(C.a,{fluid:!0,className:"Drawing",src:e})))}}]),n}(i.a.Component)),Zt=(n(158),function(t){Object(w.a)(n,t);var e=Object(v.a)(n);function n(t){var r;return Object(l.a)(this,n),(r=e.call(this,t)).state={inputValue:"",error:null,galleries:[]},r.handleChange=r.handleChange.bind(Object(f.a)(r)),r.handleRestart=r.handleRestart.bind(Object(f.a)(r)),r.loadArtifact=r.loadArtifact.bind(Object(f.a)(r)),r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("message",this.handleMessage.bind(this),!1)}},{key:"handleGalleriesFrameLoad",value:function(t){t.target.contentWindow.postMessage({action:"get"},"https://jackbox.tv")}},{key:"handleMessage",value:function(t){if("https://jackbox.tv"===t.origin){var e=t.data,n=e.action,r=e.galleries;"returnData"===n&&this.setState({galleries:r})}}},{key:"handleChange",value:function(t,e){var n=e.value;if(-1!==n.indexOf("/")){var r=n.split("/");n=r.find((function(t){return 32===t.length}))}n&&(32===n.length&&this.loadArtifact(n),this.setState({inputValue:n,error:null}))}},{key:"handleRestart",value:function(t,e){this.setState({loading:!1,inputValue:"",artifact:null})}},{key:"loadArtifact",value:function(){var t=Object(u.a)(h.a.mark((function t(e){var n=this;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.setState({artifact:null,loading:!0},Object(u.a)(h.a.mark((function t(){var r,i,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="".concat("https://fishery.jackboxgames.com/artifact/TeeKOGame/").concat(e),t.prev=1,t.next=4,fetch(r);case 4:return i=t.sent,t.next=7,i.json();case 7:(a=t.sent).blob&&(a=a.blob),n.setState({artifact:a,inputValue:e,loading:!1}),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),n.setState({error:t.t0.toString(),loading:!1});case 15:case"end":return t.stop()}}),t,null,[[1,12]])}))));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this,e=this.state,n=e.artifact,r=e.inputValue,a=e.loading,o=e.galleries,s=e.error,h=o.map((function(e,n){if("TeeKOGame"!==e.categoryId)return!1;var r=new Date(e.time).toLocaleDateString(),a=e.url.split("/")[5];return i.a.createElement(d.a,{key:n,className:"galleryButton",onClick:function(){t.loadArtifact(a)}},r)})).filter((function(t){return t})),u=[];return n&&n.shirts&&n.shirts.forEach((function(t,e){u.push(i.a.createElement(Wt,{key:e,shirt:t}))})),i.a.createElement("div",{className:"TeeKOImporter"},i.a.createElement("iframe",{id:"galleriesFrame",title:"Jackbox.tv",className:"visuallyhidden",width:"1",height:"1",src:"".concat("https://jackbox.tv","/localstorage.html"),onLoad:this.handleGalleriesFrameLoad}),i.a.createElement(y.a,{className:"Instructions"},i.a.createElement(g.a,null,"How to get your Tee KO Shirts into Animal Crossing: New Horizons:"),i.a.createElement(p.a,null,i.a.createElement(p.a.Item,null,i.a.createElement(p.a.Header,{floated:"left"},"On your phone, download the Nintendo Switch Online app"),"Get the Nintendo Switch Online app from the ",i.a.createElement("a",{href:"https://apps.apple.com/us/app/nintendo-switch-online/id1234806557",target:"_blank",rel:"noopener noreferrer"},"Apple App Store")," or the ",i.a.createElement("a",{href:"https://play.google.com/store/apps/details?id=com.nintendo.znca",target:"_blank",rel:"noopener noreferrer"},"Google Play App Store")),i.a.createElement(p.a.Item,null,i.a.createElement(p.a.Header,null,"In Animal Crossing: New Horizons, connect your account"),"Follow the instructions in the Nintendo Switch Online app to set up your connection to the Animal Crossing: New Horizons game"),i.a.createElement(p.a.Item,null,i.a.createElement(p.a.Header,null,"In Nintendo Switch Online: Scan a QR Code"),'Open the Animal Crossing service (NookLink). Select the "Designs" tile, then press "Scan a QR Code"'),i.a.createElement(p.a.Item,null,i.a.createElement(p.a.Header,null,"In Animal Crossing: New Horizons, Download the design"),"Open your NookPhone, and select Custom Designs. Press the '+' to download the saved pattern."))),h.length>0&&i.a.createElement(y.a,null,i.a.createElement(g.a,{textAlign:"center"},"Choose a Past TeeKO Game"),h),i.a.createElement(y.a,null,i.a.createElement(g.a,{textAlign:"center"},"Enter a Tee KO Gallery URL")),i.a.createElement(y.a,{className:"ArtifactForm"},!n&&i.a.createElement(m.a,null,i.a.createElement(m.a.Field,null,i.a.createElement(I.a,{fluid:!0,loading:a,iconPosition:"left",value:r,onChange:this.handleChange,placeholder:"Enter your Artifact ID",disabled:a}),s&&i.a.createElement(A.a,{basic:!0,color:"red",pointing:!0},s))),n&&i.a.createElement("div",null,i.a.createElement(A.a,null,r),i.a.createElement(d.a,{className:"galleryButton",onClick:this.handleRestart},"X"))),n&&i.a.createElement(y.a,null,i.a.createElement(S.a.Group,null,u)))}}]),n}(i.a.Component));n(159);var Kt=function(){return i.a.createElement("div",{className:"App"},i.a.createElement(Zt,{value:1}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(Kt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[143,1,2]]]);
//# sourceMappingURL=main.d96a69c4.chunk.js.map